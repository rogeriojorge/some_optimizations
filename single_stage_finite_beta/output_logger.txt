[1] INFO:simsopt.mhd.vmec:279 Initializing a VMEC object from input file: /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/input.QH_finitebeta
[1] INFO:simsopt.mhd.vmec:330 About to call runvmec to readin
[0] INFO:simsopt.mhd.vmec:279 Initializing a VMEC object from input file: /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/input.QH_finitebeta
[0] INFO:simsopt.mhd.vmec:330 About to call runvmec to readin
[0] INFO:simsopt.mhd.vmec:333 Done with runvmec. ierr=0. Calling cleanup next.
[1] INFO:simsopt.mhd.vmec:333 Done with runvmec. ierr=0. Calling cleanup next.
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000000.nc
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_000_000000.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:absl:174 Remote TPU is not linked into jax; skipping remote TPU.
[0] INFO:absl:350 Unable to initialize backend 'tpu_driver': Could not initialize backend 'tpu_driver'
[0] INFO:absl:350 Unable to initialize backend 'cuda': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[0] INFO:absl:350 Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[0] INFO:absl:350 Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.13125988 -0.07246449  0.15687388  0.0036007   0.11319857  0.06757274
  0.15929478  0.00502891]
[0] INFO:__main__:299 True coils dofs = [ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4899247210163211
[0] INFO:root:288 J_stage_1=0.4899247210163211
[0] INFO:root:289 J_stage_2=0.42658822334164914
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.9165129443579703 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:__main__:333 True vmec dofs = [ 0.13125988 -0.07246449  0.15687388  0.0036007   0.11319857  0.06757274
  0.15929478  0.00502891]
[0] INFO:__main__:334 True JF.x = [ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4899247210163211
[0] INFO:root:288 J_stage_1=0.4899247210163211
[0] INFO:root:289 J_stage_2=0.42658822334164914
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.13125988 -0.07246449  0.15687388  0.0036007   0.11319857  0.06757274
  0.15929478  0.00502891]
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.13125988 -0.07246449  0.15687388  0.0036007   0.11319857  0.06757274
  0.15929478  0.00502891]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4899247210163211
[0] INFO:root:288 J_stage_1=0.4899247210163211
[0] INFO:root:289 J_stage_2=0.42658822334164914
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:262 JF.x=[1.2080807  1.2080807  1.2080807  0.99518473 0.         0.59711084
 0.        ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 7.24644861e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[-0.07549135 -0.04916294 -0.01848311  0.12397813  0.00143168 -0.20024743
 -0.01049813]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[1.31259877e-05 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000001.nc
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000001.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4903947992668701
[0] INFO:root:288 J_stage_1=0.4903947992668701
[0] INFO:root:289 J_stage_2=0.4265386133444212
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -7.24644861e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4900842479808843
[1] INFO:absl:174 Remote TPU is not linked into jax; skipping remote TPU.
[1] INFO:absl:350 Unable to initialize backend 'tpu_driver': Could not initialize backend 'tpu_driver'
[1] INFO:absl:350 Unable to initialize backend 'cuda': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[1] INFO:absl:350 Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[1] INFO:absl:350 Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000002.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:root:288 J_stage_1=0.4900842479808843
[1] INFO:root:289 J_stage_2=0.42661862218531765
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.31259877e-05  0.00000000e+00  1.56873876e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000002.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4900026613309294
[0] INFO:root:288 J_stage_1=0.4900026613309294
[0] INFO:root:289 J_stage_2=0.4265834565173997
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  6.75727361e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000003.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4904227750321647
[1] INFO:root:288 J_stage_1=0.4904227750321647
[1] INFO:root:289 J_stage_2=0.42659978717053454
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.56873876e-05  0.00000000e+00
  1.13198572e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4903818191512725
[0] INFO:root:288 J_stage_1=0.4903818191512725
[0] INFO:root:289 J_stage_2=0.42660920648301653
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -6.75727361e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000003.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000004.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.48983059939326895
[1] INFO:root:288 J_stage_1=0.48983059939326895
[1] INFO:root:289 J_stage_2=0.4266019646621672
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.13198572e-05  0.00000000e+00  1.59294776e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.489979238681813
[0] INFO:root:288 J_stage_1=0.489979238681813
[0] INFO:root:289 J_stage_2=0.4265857050918656
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000004.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.48935329542922346
[1] INFO:root:288 J_stage_1=0.48935329542922346
[1] INFO:root:289 J_stage_2=0.42661880541058617
[0] INFO:root:336 grad_with_respect_to_coils=[-5.49760080e-02 -3.98570272e-02 -5.87735937e-03 -7.49362062e-01
  5.41915463e-03 -4.11201618e-02 -2.66262523e-01 -5.10885272e-02
  3.99637242e-01 -4.22081834e-01 -3.14470511e-03  4.94331985e-01
  1.93861045e+00 -3.00038843e-01 -4.06359871e+00 -5.72743184e-01
  7.10530596e+00  2.65685170e+00 -8.74221451e-02 -1.03190809e+00
 -3.34839059e-01  8.77947185e-01  6.29294026e-01 -3.54262085e-01
 -8.71492460e-01 -2.65617520e-01  1.60717934e-01  8.05260399e-01
  4.50948593e-01 -1.85446341e+00 -4.88478006e+00 -1.97621177e+00
  1.43706428e+01  1.27408744e-01 -1.32298266e+00 -2.42887207e-01
  1.03490301e+00  4.68905748e-01 -9.34928454e-01 -1.19958861e+00
  1.14020410e+00  3.16991208e+00 -1.18426432e+00 -4.23185634e+00
  7.98227625e-01  6.91852370e+00 -6.53301297e-02 -7.04330277e+00
 -6.10246839e-01  8.10805864e-02  6.33160643e-01  7.81914397e-02
 -7.98877115e-01 -2.00830734e-01  1.89448042e-01 -2.61679451e-02
 -2.64423428e-02 -2.14147070e-02 -9.66443728e-02 -4.41586393e-02
  4.98537742e-02  1.61437127e-02  3.19606216e-02 -1.99251169e-01
 -7.66910673e-01 -6.24669381e-02  1.76375403e-01  6.99666164e-01
 -7.69814933e-02 -1.16416725e-01  1.37965568e-01  2.99670702e-02
  1.96897182e-02 -3.19941245e-02 -4.08591028e-02 -7.15011822e-03
 -3.79979407e-03 -1.73987905e-02  5.26583060e-01  1.08460244e-01
 -2.96600231e-01 -1.02411929e-01  1.55213609e-01 -2.65200947e-02
  8.08962318e-02 -6.19785026e-02 -9.47951170e-02 -1.02718385e-01
  7.00626253e-02  7.76401817e-02  6.73280590e-02 -2.03396734e-02
 -3.54079815e-02 -1.11752394e-01  2.14606416e-01  3.93822518e-01
  5.40906503e-01 -8.44351431e-01 -3.30564825e-01 -1.01203081e-01
  1.02310008e-02 -2.74041961e-01 -3.23869335e-02  4.00864075e-02
 -2.99355529e-02 -3.83660277e-02  1.43406584e-02 -2.06827706e-02
 -1.68882564e-02 -7.68190787e-01 -1.59989586e-01 -4.25324351e-01
  6.20273644e-01  7.53175809e-02 -1.75297486e-01 -5.80578320e-02
  1.61996082e-01  5.26092845e-02  7.07099309e-02  8.57665432e-02
 -6.96553841e-02 -6.32525785e-03 -2.07036963e-02  8.59001016e-01
  4.47019787e-01 -3.62484564e-01 -4.52196085e-01  2.29208183e-01
 -1.45380292e-01  1.05361884e-02  5.19133550e-02  1.01997489e-01
 -2.24910626e-02 -1.28720030e-01 -1.32788073e-01  2.31140658e-02
  2.78070751e-02  2.32862069e-02  4.28477293e-01  4.32749213e-01
  2.26971374e-01  9.40473106e-01 -5.56567067e-01 -1.27523892e-01
 -3.74793145e-01  1.89257360e-01 -1.20494627e-01 -2.17856574e-02
 -2.63753944e-02  1.07062186e-01 -5.38222831e-02 -2.21698807e-02
  1.37779833e-02  4.35540779e-01 -6.84452403e-01 -4.20747561e-02
 -9.11309330e-01  4.52391562e-02  1.27229438e-02 -1.79976343e-01
 -1.52075472e-01  3.45757665e-02 -4.64089674e-02  1.44600238e-02
  8.27363293e-03  1.18744199e-01 -4.08494819e-04  9.02425462e-03
  5.41696359e-01  8.82320803e-01 -1.70526485e-01 -7.92687119e-01
  9.67237780e-02 -1.75254538e-01 -3.78943734e-02 -2.62782299e-01
  1.47430568e-01  1.06998934e-01 -4.23122204e-03  3.30469843e-02
 -8.51433866e-02  3.90325848e-03 -1.57790242e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[ 14.46944884  58.02404404  32.48583235  73.17349036  -7.10082302
  70.75061687 -33.95237002  51.99941571]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.02624636 -0.49357999 -0.07889541 -0.52746348  0.16473353 -0.44590719
  0.40570761 -0.37236223]
[0] INFO:__main__:299 True coils dofs = [ 1.13298834  1.15920702  1.18964024  1.12460143  0.00139235  0.39716184
 -0.0085657 ]
[0] INFO:root:261 dofs_coils=[ 1.13298834  1.15920702  1.18964024  1.12460143  0.00139235  0.39716184
 -0.0085657 ]
[0] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 3.98994067e-04  2.89266499e-04  4.26555438e-05  5.43857270e-03
 -3.93300755e-05  2.98433829e-04  1.93242782e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.10501352 -0.4211155  -0.23576929 -0.53106418  0.05153496 -0.51347992
  0.24641284 -0.37739214]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] WARNING:simsopt.objectives.least_squares:158 Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=5 ntor=5)>
[0] INFO:simsopt.objectives.least_squares:214 objective(): 4.435299999998633e+28
[0] INFO:root:288 J_stage_1=4.435299999998633e+28
[0] INFO:root:289 J_stage_2=161.05303932455348
[0] INFO:__main__:303 Exception caught during function evaluation with J=4.435299999998633e+28. Returning J=250
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:374 Objective function 250 is greater than the threshold 250
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.12355686 -0.10335442  0.13957958 -0.03535425  0.1169788   0.02990763
  0.17736981 -0.02265372]
[0] INFO:__main__:299 True coils dofs = [ 1.13261862  1.15893897  1.18960071  1.11956179  0.0014288   0.39688529
 -0.01035638]
[0] INFO:root:261 dofs_coils=[ 1.13261862  1.15893897  1.18960071  1.11956179  0.0014288   0.39688529
 -0.01035638]
[0] INFO:root:262 JF.x=[ 1.13298834  1.15920702  1.18964024  1.12460143  0.00139235  0.39716184
 -0.0085657 ]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[-3.69726802e-04 -2.68048040e-04 -3.95266474e-05 -5.03963909e-03
  3.64451110e-05 -2.76542923e-04 -1.79067915e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0973105   0.39022557  0.21847499  0.49210922 -0.04775473  0.47581482
 -0.22833781  0.34970851]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] WARNING:simsopt.objectives.least_squares:158 Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=5 ntor=5)>
[0] INFO:simsopt.objectives.least_squares:214 objective(): 4.435299999998633e+28
[0] INFO:root:288 J_stage_1=4.435299999998633e+28
[0] INFO:root:289 J_stage_2=1.7600875170162884
[0] INFO:__main__:303 Exception caught during function evaluation with J=4.435299999998633e+28. Returning J=250
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:374 Objective function 250 is greater than the threshold 250
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.13120781 -0.07267327  0.15675699  0.00333741  0.11322412  0.06731816
  0.15941694  0.00484181]
[0] INFO:__main__:299 True coils dofs = [ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:262 JF.x=[ 1.13261862  1.15893897  1.18960071  1.11956179  0.0014288   0.39688529
 -0.01035638]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[-2.90694514e-05 -2.10750463e-05 -3.10774861e-06 -3.96237283e-04
  2.86546546e-06 -2.17429491e-05 -1.40790606e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00765095  0.03068115  0.01717741  0.03869166 -0.00375467  0.03741053
 -0.01795286  0.02749553]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000009.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4253107619290907
[0] INFO:root:288 J_stage_1=0.4253107619290907
[0] INFO:root:289 J_stage_2=0.4274040438522774
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.852714805781368 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:__main__:333 True vmec dofs = [ 0.13120781 -0.07267327  0.15675699  0.00333741  0.11322412  0.06731816
  0.15941694  0.00484181]
[0] INFO:__main__:334 True JF.x = [ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.13120781 -0.07267327  0.15675699  0.00333741  0.11322412  0.06731816
  0.15941694  0.00484181]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.13120781 -0.07267327  0.15675699  0.00333741  0.11322412  0.06731816
  0.15941694  0.00484181]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4253107619290907
[0] INFO:root:288 J_stage_1=0.4253107619290907
[0] INFO:root:289 J_stage_2=0.4274040438522774
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:262 JF.x=[ 1.13258935  1.15891775  1.18959759  1.11916286  0.00143168  0.3968634
 -0.01049813]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 7.26732664e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.97812920e-07  1.43412285e-07  2.11477271e-08  2.69633069e-06
 -1.94990295e-08  1.47957256e-07  9.58057327e-07]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-3.89427284e-05 -2.08780266e-04 -1.16889487e-04 -2.63290521e-04
  2.55499551e-05 -2.54572615e-04  1.06236858e-04 -1.87102641e-04]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000010.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000005.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.42570261285828154
[0] INFO:root:288 J_stage_1=0.42570261285828154
[0] INFO:root:289 J_stage_2=0.4273536362372013
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -7.26732664e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4254631703224481
[1] INFO:root:288 J_stage_1=0.4254631703224481
[1] INFO:root:289 J_stage_2=0.4274342055195485
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.31207814e-05  0.00000000e+00  1.56756987e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000011.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000006.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.42537653888154703
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:root:288 J_stage_1=0.42537653888154703
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:root:289 J_stage_2=0.4273991706062106
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  6.73181635e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.42573898875353605
[1] INFO:root:288 J_stage_1=0.42573898875353605
[1] INFO:root:289 J_stage_2=0.4274153057705087
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.56756987e-05  0.00000000e+00
  1.13224122e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000012.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000007.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.42568712225595323
[0] INFO:root:288 J_stage_1=0.42568712225595323
[0] INFO:root:289 J_stage_2=0.427424242661431
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -6.73181635e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000013.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4252163699988672
[1] INFO:root:288 J_stage_1=0.4252163699988672
[1] INFO:root:289 J_stage_2=0.4274176874300497
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.13224122e-05  0.00000000e+00  1.59416942e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000008.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.42535534723083585
[0] INFO:root:288 J_stage_1=0.42535534723083585
[0] INFO:root:289 J_stage_2=0.42740143933018254
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4248287286094591
[1] INFO:root:288 J_stage_1=0.4248287286094591
[1] INFO:root:289 J_stage_2=0.4274356297834658
[0] INFO:root:336 grad_with_respect_to_coils=[-5.93219560e-02 -4.20934930e-02 -6.53886091e-03 -7.46408064e-01
  8.61457140e-03 -2.18535454e-02 -2.62070178e-01 -5.50475207e-02
  3.90509641e-01 -4.09737679e-01 -3.89128202e-03  4.81289305e-01
  1.88364552e+00 -2.93801801e-01 -3.94733387e+00 -5.54334856e-01
  6.90164283e+00  2.57466761e+00 -8.36579089e-02 -1.01171762e+00
 -3.20993132e-01  8.50434235e-01  6.12958261e-01 -3.36438325e-01
 -8.40346070e-01 -2.66133925e-01  1.46856285e-01  7.83364864e-01
  4.38104961e-01 -1.79667003e+00 -4.73496067e+00 -1.91905574e+00
  1.39319741e+01  1.27059447e-01 -1.27314769e+00 -2.34687577e-01
  9.93909497e-01  4.50409934e-01 -8.98839286e-01 -1.15522598e+00
  1.09919515e+00  3.06619411e+00 -1.14635416e+00 -4.09276504e+00
  7.73967157e-01  6.69536477e+00 -6.55040895e-02 -6.82008874e+00
 -6.14180611e-01  8.27816506e-02  6.30763727e-01  7.71367228e-02
 -7.98960352e-01 -2.01394318e-01  1.89056163e-01 -2.61932181e-02
 -2.60768338e-02 -2.07377429e-02 -9.72652236e-02 -4.43879528e-02
  5.01241517e-02  1.63547885e-02  3.18712943e-02 -1.96093137e-01
 -7.66840731e-01 -5.84027984e-02  1.76619246e-01  6.99070129e-01
 -7.62544934e-02 -1.16041673e-01  1.37381272e-01  2.97102738e-02
  1.97657562e-02 -3.22792408e-02 -4.10283073e-02 -7.13826686e-03
 -3.84234794e-03 -1.72532985e-02  5.27788862e-01  1.06093320e-01
 -2.96284736e-01 -1.04410169e-01  1.57007677e-01 -2.61436630e-02
  8.11861721e-02 -6.21125473e-02 -9.43604965e-02 -1.03069941e-01
  6.95060802e-02  7.77975936e-02  6.73028237e-02 -2.03763539e-02
 -3.54842766e-02 -1.15972137e-01  2.15621761e-01  3.91060831e-01
  5.40760251e-01 -8.47573262e-01 -3.31325373e-01 -1.01523592e-01
  9.57096664e-03 -2.74962747e-01 -3.16874075e-02  4.04540416e-02
 -3.03650861e-02 -3.86543353e-02  1.43990336e-02 -2.05043493e-02
 -1.61909742e-02 -7.68947685e-01 -1.58681000e-01 -4.25656586e-01
  6.21066710e-01  7.46144723e-02 -1.74826411e-01 -5.75841186e-02
  1.61785748e-01  5.28490920e-02  7.09750997e-02  8.59506634e-02
 -6.99092002e-02 -6.38726747e-03 -2.08092702e-02  8.61538221e-01
  4.43316897e-01 -3.63237238e-01 -4.54934323e-01  2.30809961e-01
 -1.45946310e-01  1.14860982e-02  5.14414261e-02  1.02385149e-01
 -2.24847294e-02 -1.29250876e-01 -1.32848612e-01  2.34662450e-02
  2.78454892e-02  2.31907221e-02  4.26088607e-01  4.33723486e-01
  2.24075304e-01  9.43098529e-01 -5.59780556e-01 -1.28103080e-01
 -3.76421065e-01  1.90100982e-01 -1.21750076e-01 -2.18466154e-02
 -2.59754520e-02  1.07411548e-01 -5.43351950e-02 -2.22053869e-02
  1.37267159e-02  4.34776480e-01 -6.85644852e-01 -4.32267083e-02
 -9.14043758e-01  4.49171338e-02  1.17835924e-02 -1.81176562e-01
 -1.52567822e-01  3.49489253e-02 -4.66109465e-02  1.47226118e-02
  8.11199122e-03  1.19066619e-01 -3.80567596e-04  9.15599892e-03
  5.43134413e-01  8.78470109e-01 -1.71100278e-01 -7.97231502e-01
  9.75371816e-02 -1.76993026e-01 -3.74862872e-02 -2.64098786e-01
  1.48025408e-01  1.07832522e-01 -4.84539097e-03  3.25723407e-02
 -8.49974351e-02  4.06166724e-03 -1.58974727e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[ 13.91457224  46.98334493  28.03630967  60.90370639  -7.13172698
  58.90819289 -28.25592948  41.98077965]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.12888737 -0.07154102  0.15534046  0.00280754  0.11472186  0.06678086
  0.15965892  0.00600365]
[0] INFO:__main__:299 True coils dofs = [ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.64580032e-05  1.08493675e-05  1.99259629e-06  1.50699927e-04
 -4.89840938e-06 -1.43498806e-05  4.98256107e-05]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00232044  0.00113224 -0.00141653 -0.00052987  0.00149774 -0.0005373
  0.00024197  0.00116084]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000014.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.41735320555534366
[0] INFO:root:288 J_stage_1=0.41735320555534366
[0] INFO:root:289 J_stage_2=0.3822944455800733
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.7996476511354169 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:__main__:333 True vmec dofs = [ 0.12888737 -0.07154102  0.15534046  0.00280754  0.11472186  0.06678086
  0.15965892  0.00600365]
[0] INFO:__main__:334 True JF.x = [ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.12888737 -0.07154102  0.15534046  0.00280754  0.11472186  0.06678086
  0.15965892  0.00600365]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.12888737 -0.07154102  0.15534046  0.00280754  0.11472186  0.06678086
  0.15965892  0.00600365]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.41735320555534366
[0] INFO:root:288 J_stage_1=0.41735320555534366
[0] INFO:root:289 J_stage_2=0.3822944455800733
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:262 JF.x=[ 1.13258955  1.1589179   1.18959761  1.11916555  0.00143166  0.39686355
 -0.01049717]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 7.15410248e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.64580032e-05  1.08493675e-05  1.99259629e-06  1.50699927e-04
 -4.89840938e-06 -1.43498806e-05  4.98256107e-05]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00230755  0.00113224 -0.00141653 -0.00052987  0.00149774 -0.0005373
  0.00022603  0.00116184]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000015.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000009.nc
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.41776027901431384
[0] INFO:root:288 J_stage_1=0.41776027901431384
[0] INFO:root:289 J_stage_2=0.38224573834584996
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -7.15410248e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4174269091593256
[1] INFO:root:288 J_stage_1=0.4174269091593256
[1] INFO:root:289 J_stage_2=0.3823176708583552
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.28887374e-05  0.00000000e+00  1.55340461e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000016.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000010.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.41740450184705874
[0] INFO:root:288 J_stage_1=0.41740450184705874
[0] INFO:root:289 J_stage_2=0.3822894036736111
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  6.67808627e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.41777902855358473
[1] INFO:root:288 J_stage_1=0.41777902855358473
[1] INFO:root:289 J_stage_2=0.3823058327993977
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.55340461e-05  0.00000000e+00
  1.14721859e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000017.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000011.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4177552161109907
[0] INFO:root:288 J_stage_1=0.4177552161109907
[0] INFO:root:289 J_stage_2=0.3823139750773142
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -6.67808627e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000018.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4173270810431686
[1] INFO:root:288 J_stage_1=0.4173270810431686
[1] INFO:root:289 J_stage_2=0.38231287950410997
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.14721859e-05  0.00000000e+00  1.59658917e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000012.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.41742184112882413
[0] INFO:root:288 J_stage_1=0.41742184112882413
[0] INFO:root:289 J_stage_2=0.38229226982507464
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4168297282891533
[1] INFO:root:288 J_stage_1=0.4168297282891533
[1] INFO:root:289 J_stage_2=0.3823237695202186
[0] INFO:root:336 grad_with_respect_to_coils=[-0.06789733 -0.04271755 -0.0066538  -0.65758343  0.09140954  0.55120587
 -0.14691338 -0.20893346  0.03802686  0.12105733  0.06089499 -0.10331644
 -0.07529739  0.03247767 -0.02119196  0.02130405  0.06452049 -0.02773284
 -0.07138595 -0.61979105  0.01785171  0.33307661  0.24847278 -0.02223195
  0.02345241 -0.03066501 -0.02221388  0.00856039 -0.07702099 -0.01751153
  0.01199418  0.00417164  0.06102972  0.14942781  0.1370209  -0.02465795
 -0.11265149 -0.0467725   0.07515897  0.04281019 -0.06312572  0.05176726
  0.02015224 -0.00754466  0.00359287  0.02370459  0.00104246 -0.06026874
 -0.58076389  0.10426033  0.5475625   0.07094615 -0.77898042 -0.19304029
  0.16954786 -0.02733088 -0.03394424 -0.02534443 -0.09685768 -0.03811619
  0.04887731  0.01462389  0.02867326 -0.2258582  -0.78327989 -0.00643003
  0.20009299  0.70752559 -0.06428689 -0.11404454  0.12540206  0.02366073
  0.02056886 -0.03013338 -0.04143129 -0.00952983 -0.00453979 -0.01378257
  0.57254289  0.11466422 -0.28277922 -0.12453987  0.14197556 -0.02146176
  0.08666337 -0.08005924 -0.09227701 -0.10074851  0.07405924  0.07347253
  0.06290897 -0.01773907 -0.03451231 -0.10165129  0.22014245  0.32962994
  0.5150671  -0.83899105 -0.31303232 -0.10937835  0.0086174  -0.27443654
 -0.03384661  0.03062368 -0.02656714 -0.03565993  0.01516916 -0.02494207
 -0.05379347 -0.75259418 -0.13978286 -0.38674298  0.61625917  0.08408938
 -0.17578708 -0.0598684   0.14623416  0.043851    0.07094607  0.08731048
 -0.06752094 -0.00779815 -0.02421493  0.87562538  0.46919626 -0.33887943
 -0.45412459  0.19582661 -0.16339799  0.0259525   0.04715585  0.09583685
 -0.03169452 -0.12007699 -0.12905168  0.02122415  0.02364886  0.02333499
  0.40054103  0.41657371  0.18420177  0.88370646 -0.55632854 -0.12524995
 -0.3612438   0.18803788 -0.11836507 -0.01730623 -0.03308343  0.1037413
 -0.05083758 -0.01702463  0.01472612  0.39686409 -0.65211112 -0.05096668
 -0.85116272  0.03664744  0.02388156 -0.17373591 -0.14766854  0.03039804
 -0.04884907  0.00561073  0.00912522  0.11541913  0.00236596  0.01075426
  0.53894218  0.89547212 -0.15451202 -0.76807597  0.0778332  -0.2037875
 -0.0348147  -0.2576769   0.14478697  0.09061034 -0.00244527  0.03212737
 -0.08189475  0.00488162 -0.01877591]
[0] INFO:root:337 grad_with_respect_to_surface=[  7.52043268  50.09240864  28.14528898  46.25438525  -0.67036816
  63.12288223 -30.95056232  66.45981848]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.12599642 -0.06959137  0.1530457   0.00510762  0.11618444  0.06563833
  0.16030017  0.00409454]
[0] INFO:__main__:299 True coils dofs = [ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 3.06438003e-05  1.92621403e-05  3.54965155e-06  2.48319964e-04
 -2.37130836e-05 -1.29671063e-04  6.64442381e-05]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00289095  0.00194966 -0.00229477  0.00230008  0.00146258 -0.00114253
  0.00064126 -0.00191011]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000019.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.39472422654654366
[0] INFO:root:288 J_stage_1=0.39472422654654366
[0] INFO:root:289 J_stage_2=0.35292905347501846
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.7476532800215621 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:__main__:333 True vmec dofs = [ 0.12599642 -0.06959137  0.1530457   0.00510762  0.11618444  0.06563833
  0.16030017  0.00409454]
[0] INFO:__main__:334 True JF.x = [ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.12599642 -0.06959137  0.1530457   0.00510762  0.11618444  0.06563833
  0.16030017  0.00409454]
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.12599642 -0.06959137  0.1530457   0.00510762  0.11618444  0.06563833
  0.16030017  0.00409454]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.39472422654654366
[0] INFO:root:288 J_stage_1=0.39472422654654366
[0] INFO:root:289 J_stage_2=0.35292905347501846
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:262 JF.x=[ 1.13260601  1.15892875  1.1895996   1.11931625  0.00142677  0.3968492
 -0.01044735]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 6.95913669e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 3.06438003e-05  1.92621403e-05  3.54965155e-06  2.48319964e-04
 -2.37130836e-05 -1.29671063e-04  6.64442381e-05]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00287836  0.00194966 -0.00229477  0.00230008  0.00146258 -0.00114253
  0.00062529 -0.00190911]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000020.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000013.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.39513887024147665
[0] INFO:root:288 J_stage_1=0.39513887024147665
[0] INFO:root:289 J_stage_2=0.3528823909474285
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -6.95913669e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3948422657375717
[1] INFO:root:288 J_stage_1=0.3948422657375717
[1] INFO:root:289 J_stage_2=0.3529437984176699
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.25996419e-05  0.00000000e+00  1.53045696e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000021.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000014.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.39480074120992903
[0] INFO:root:288 J_stage_1=0.39480074120992903
[0] INFO:root:289 J_stage_2=0.3529248213967015
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  6.56383309e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3951084189759899
[1] INFO:root:288 J_stage_1=0.3951084189759899
[1] INFO:root:289 J_stage_2=0.35294050679021194
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.53045696e-05  0.00000000e+00
  1.16184443e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000022.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000015.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3951270909106357
[0] INFO:root:288 J_stage_1=0.3951270909106357
[0] INFO:root:289 J_stage_2=0.35294660613188283
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -6.56383309e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000023.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3946507570660734
[1] INFO:root:288 J_stage_1=0.3946507570660734
[1] INFO:root:289 J_stage_2=0.3529526860882071
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.16184443e-05  0.00000000e+00  1.60300173e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000016.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3947665835960716
[0] INFO:root:288 J_stage_1=0.3947665835960716
[0] INFO:root:289 J_stage_2=0.3529261782474436
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.39422883476991455
[1] INFO:root:288 J_stage_1=0.39422883476991455
[1] INFO:root:289 J_stage_2=0.35295446701764843
[0] INFO:root:336 grad_with_respect_to_coils=[-7.73507550e-02 -4.78790081e-02 -7.87387215e-03 -5.32759473e-01
  1.01220334e-01  4.20137286e-01 -1.33607449e-01 -1.15850591e-01
  3.40565697e-02  8.18716160e-02  5.05208150e-02 -9.96589422e-02
 -7.31369116e-02  3.68729157e-02 -1.10248587e-02  1.72692891e-02
  5.05903051e-02 -2.36464631e-02 -7.51319138e-02 -6.68109009e-01
  6.81771906e-02  3.80670097e-01  2.27939078e-01 -4.06530264e-02
  1.40628217e-02 -2.81000676e-02 -2.38625667e-02  1.18338358e-02
 -5.92611476e-02 -1.96855433e-02  4.91051693e-03  1.01093922e-02
  4.71021831e-02  1.79645244e-01  1.51409942e-01 -3.21100904e-02
 -1.20666699e-01 -4.58382255e-02  8.07649536e-02  5.02802821e-02
 -8.48663037e-02  3.74123328e-02  3.34035500e-02  6.43297862e-03
  3.20374046e-03  1.01284006e-02 -2.19810789e-03 -4.58249187e-02
 -5.28891256e-01  1.04497224e-01  4.33995982e-01  6.97676820e-02
 -6.71077454e-01 -1.69880301e-01  1.17450570e-01 -4.58945110e-02
 -2.79147666e-02 -1.29118004e-02 -7.90252617e-02 -3.04715167e-02
  3.54936832e-02  5.83611692e-03  3.12786215e-02 -2.46625145e-01
 -7.85018911e-01  6.44160821e-02  2.50742305e-01  6.58310737e-01
 -8.05920734e-02 -1.24929489e-01  1.15006312e-01  2.60609897e-02
  2.05028819e-02 -2.91331050e-02 -3.99961913e-02 -1.16446947e-02
 -5.67151243e-03 -8.31016566e-03  6.34095220e-01  1.42970776e-01
 -2.86136820e-01 -1.69354821e-01  1.08945770e-01 -1.94834837e-04
  1.08171162e-01 -1.03390984e-01 -1.00363397e-01 -7.76745919e-02
  8.18991286e-02  6.07073727e-02  4.60381251e-02 -9.73346988e-03
 -2.58230741e-02 -9.98125180e-02  1.94046461e-01  2.41142626e-01
  4.74672513e-01 -7.63921853e-01 -2.68188138e-01 -1.14410477e-01
 -8.17148208e-03 -2.67880583e-01 -3.23695028e-02  3.96857622e-02
 -1.31246349e-02 -2.83546230e-02  1.22394789e-02 -3.23575069e-02
 -8.32200744e-02 -7.15285830e-01 -9.21782896e-02 -3.31404718e-01
  5.78599148e-01  7.04003009e-02 -1.76175353e-01 -5.36382040e-02
  1.30250543e-01  3.85050217e-02  7.01510601e-02  9.12537244e-02
 -6.63519006e-02 -1.33180834e-02 -2.97420767e-02  8.82448667e-01
  4.71722571e-01 -3.19143081e-01 -4.79403509e-01  1.47220669e-01
 -1.68314562e-01  6.49046266e-02  5.23429333e-02  7.47701690e-02
 -3.14827446e-02 -1.07027687e-01 -1.17307297e-01  7.28324019e-03
  1.44176425e-02  2.88031538e-02  3.53666546e-01  3.81600613e-01
  1.31850760e-01  8.23938663e-01 -5.26800623e-01 -9.62192914e-02
 -3.39827331e-01  1.73274432e-01 -1.24746261e-01 -2.28980522e-02
 -2.97502485e-02  9.64175735e-02 -3.47526512e-02 -1.07149551e-02
  1.41533725e-02  3.41482709e-01 -6.11685801e-01 -4.47541108e-02
 -7.93986091e-01  2.75060230e-02  8.46674958e-03 -1.64126239e-01
 -1.37265787e-01  2.49210828e-02 -4.26009165e-02  3.62593921e-03
  1.55962267e-02  1.16459234e-01  5.82489975e-03  1.10837060e-02
  5.22786517e-01  8.70866677e-01 -1.37827847e-01 -7.78985111e-01
  5.49237858e-02 -2.31303581e-01 -1.95841968e-02 -2.30937065e-01
  1.33357743e-01  7.59484076e-02  2.41230453e-03  4.95208000e-02
 -8.16608822e-02  2.82501511e-03 -2.48862366e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[ 10.53872279  52.8774162   25.85147802  72.28258507  -4.28946129
  64.05053501 -29.31863548  39.48182195]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.12046368 -0.06579014  0.14950664  0.00584801  0.11874995  0.06282106
  0.16113449  0.00451179]
[0] INFO:__main__:299 True coils dofs = [ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 8.01289217e-05  4.79953994e-05  9.01608369e-06  4.82251375e-04
 -9.37437718e-05 -4.72117864e-04  1.01485242e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00553274  0.00380123 -0.00353906  0.00074039  0.00256551 -0.00281727
  0.00083432  0.00041625]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000024.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3714523327470776
[0] INFO:root:288 J_stage_1=0.3714523327470776
[0] INFO:root:289 J_stage_2=0.30870224070682367
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.6801545734539013 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:__main__:333 True vmec dofs = [ 0.12046368 -0.06579014  0.14950664  0.00584801  0.11874995  0.06282106
  0.16113449  0.00451179]
[0] INFO:__main__:334 True JF.x = [ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.12046368 -0.06579014  0.14950664  0.00584801  0.11874995  0.06282106
  0.16113449  0.00451179]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.12046368 -0.06579014  0.14950664  0.00584801  0.11874995  0.06282106
  0.16113449  0.00451179]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3714523327470776
[0] INFO:root:288 J_stage_1=0.3714523327470776
[0] INFO:root:289 J_stage_2=0.30870224070682367
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:262 JF.x=[ 1.13263665  1.15894801  1.18960315  1.11956457  0.00140305  0.39671953
 -0.0103809 ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 6.57901358e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 8.01289217e-05  4.79953994e-05  9.01608369e-06  4.82251375e-04
 -9.37437718e-05 -4.72117864e-04  1.01485242e-04]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.0055207   0.00380123 -0.00353906  0.00074039  0.00256551 -0.00281727
  0.00081829  0.00041725]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000025.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000017.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.37186492591100756
[0] INFO:root:288 J_stage_1=0.37186492591100756
[0] INFO:root:289 J_stage_2=0.3086603573408327
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -6.57901358e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.37149470830943626
[1] INFO:root:288 J_stage_1=0.37149470830943626
[1] INFO:root:289 J_stage_2=0.3087022942700504
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.20463676e-05  0.00000000e+00  1.49506636e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000026.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000018.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.37152045360478675
[0] INFO:root:288 J_stage_1=0.37152045360478675
[0] INFO:root:289 J_stage_2=0.30869828867643617
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0000000e-06
  0.0000000e+00  6.2821058e-06  0.0000000e+00  0.0000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.37180433062283647
[1] INFO:root:288 J_stage_1=0.37180433062283647
[1] INFO:root:289 J_stage_2=0.30871268937115554
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.49506636e-05  0.00000000e+00
  1.18749949e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000027.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000019.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3718430602139967
[0] INFO:root:288 J_stage_1=0.3718430602139967
[0] INFO:root:289 J_stage_2=0.30871645283158405
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -6.2821058e-06  0.0000000e+00  1.0000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000028.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.37144480132196184
[1] INFO:root:288 J_stage_1=0.37144480132196184
[1] INFO:root:289 J_stage_2=0.30873475301551717
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.18749949e-05  0.00000000e+00  1.61134488e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000020.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3715075788664985
[0] INFO:root:288 J_stage_1=0.3715075788664985
[0] INFO:root:289 J_stage_2=0.3086994858422628
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3709866060882469
[1] INFO:root:288 J_stage_1=0.3709866060882469
[1] INFO:root:289 J_stage_2=0.3087229481595241
[0] INFO:root:336 grad_with_respect_to_coils=[-9.84659770e-02 -5.41621891e-02 -9.44941474e-03 -2.99866505e-01
  1.44544422e-01  2.24170115e-01 -1.05121046e-01  3.93085454e-02
  4.53011966e-02  3.85614647e-02  5.22374501e-02 -1.19655578e-01
 -7.77114035e-02  3.04266270e-02 -1.60992977e-03  1.11510234e-02
  4.59522195e-02 -1.69423197e-02 -6.03164287e-02 -7.09052686e-01
  1.75521097e-01  3.15656288e-01  1.84095869e-01 -5.68984435e-02
 -6.92051962e-03 -2.98427911e-02 -6.13287383e-03  2.18633976e-02
 -6.00969873e-02 -3.25579934e-02 -6.83374762e-04  1.46398858e-02
  6.47960206e-02  2.24469528e-01  1.86167826e-01 -1.89823555e-02
 -7.96404991e-02 -1.71307484e-02  5.50270373e-02  2.52840579e-02
 -1.15955859e-01  3.49620892e-02  3.45246573e-02 -4.22529740e-03
 -8.56222369e-04  1.25839257e-02  3.24671771e-03 -3.78435238e-02
 -4.24635262e-01  1.44861885e-01  2.24079412e-01  5.41472284e-02
 -5.40967643e-01 -1.34671482e-01  5.48067903e-02 -5.43156090e-02
 -3.71959141e-02 -8.17308325e-03 -6.43625339e-02 -1.79419839e-02
  2.23687764e-02 -2.22169616e-03  2.86739626e-02 -2.83634800e-01
 -7.83375226e-01  1.87809687e-01  2.97598098e-01  6.03401591e-01
 -7.00400900e-02 -1.22441244e-01  8.74972963e-02  1.86300113e-02
  2.16036922e-02 -2.46105666e-02 -3.94007256e-02 -1.45651894e-02
 -5.17303530e-03 -4.68980674e-04  7.12167635e-01  1.63156281e-01
 -2.56310322e-01 -2.21798734e-01  7.24142305e-02  2.46635138e-02
  1.19677151e-01 -1.43211802e-01 -1.03522037e-01 -5.61808453e-02
  8.93338267e-02  4.45845668e-02  2.66186691e-02 -2.14253451e-03
 -1.67236680e-02 -6.99049968e-02  1.96092755e-01  8.13685074e-02
  3.92799612e-01 -6.86116887e-01 -2.07234936e-01 -1.22967675e-01
 -1.49954130e-02 -2.56299891e-01 -3.29187304e-02  3.08978779e-02
  2.47163528e-04 -1.81731344e-02  1.35788080e-02 -4.24644681e-02
 -1.48013299e-01 -6.54815025e-01 -2.87524164e-02 -2.35827045e-01
  5.30520866e-01  7.24995139e-02 -1.68276649e-01 -4.80774578e-02
  9.31004875e-02  2.14001906e-02  6.79075343e-02  9.49956864e-02
 -5.99931073e-02 -1.86284841e-02 -3.92484267e-02  8.77611059e-01
  4.74731409e-01 -2.58187105e-01 -4.85028966e-01  6.80366817e-02
 -1.89312274e-01  1.11591909e-01  5.02469531e-02  4.58585644e-02
 -4.43760364e-02 -8.69617919e-02 -1.01537360e-01 -3.58522084e-03
  1.93707589e-03  3.05840611e-02  2.85645616e-01  3.41267416e-01
  3.40079285e-02  6.87092683e-01 -4.98291208e-01 -7.46481708e-02
 -3.00248673e-01  1.58682856e-01 -1.17338302e-01 -1.74430846e-02
 -3.39230360e-02  8.41198876e-02 -2.11146438e-02  6.09388068e-04
  1.69528571e-02  2.48916548e-01 -5.33193852e-01 -5.17110976e-02
 -6.57951322e-01  8.68574574e-03  1.31520472e-02 -1.45084215e-01
 -1.17080805e-01  1.78364398e-02 -3.89469151e-02 -9.13505966e-03
  1.90708779e-02  1.09516733e-01  1.28868706e-02  1.49290290e-02
  4.91030906e-01  8.25047189e-01 -9.70413118e-02 -7.27735843e-01
  1.32688740e-02 -2.85933389e-01 -4.89056720e-03 -1.97883472e-01
  1.17847181e-01  4.50835452e-02  5.77104685e-03  5.75717483e-02
 -7.33979754e-02  5.36339363e-03 -3.48056892e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[  3.52215099  56.34732223  24.2428396   64.16882732   2.10365425
  64.45921236 -27.61787442  52.49125486]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11639543 -0.05883545  0.14388206  0.00595009  0.11048239  0.05215667
  0.14957232  0.00545924]
[0] INFO:__main__:299 True coils dofs = [ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 5.78616576e-04  3.15527722e-04  6.18664786e-05  1.39216451e-03
 -7.22050644e-04 -1.08641952e-03  4.83292586e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00406824  0.00695468 -0.00562457  0.00010208 -0.00826756 -0.01066438
 -0.01156217  0.00094645]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000029.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4877603500679388
[0] INFO:root:288 J_stage_1=0.4877603500679388
[0] INFO:root:289 J_stage_2=0.17874390952644387
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.6665042595943826 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:__main__:333 True vmec dofs = [ 0.11639543 -0.05883545  0.14388206  0.00595009  0.11048239  0.05215667
  0.14957232  0.00545924]
[0] INFO:__main__:334 True JF.x = [ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11639543 -0.05883545  0.14388206  0.00595009  0.11048239  0.05215667
  0.14957232  0.00545924]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11639543 -0.05883545  0.14388206  0.00595009  0.11048239  0.05215667
  0.14957232  0.00545924]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4877603500679388
[0] INFO:root:288 J_stage_1=0.4877603500679388
[0] INFO:root:289 J_stage_2=0.17874390952644387
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:262 JF.x=[ 1.13271678  1.15899601  1.18961216  1.12004683  0.00130931  0.39624741
 -0.01027942]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.0000000e+00 5.8835455e-06 0.0000000e+00 0.0000000e+00 0.0000000e+00
 0.0000000e+00 0.0000000e+00 0.0000000e+00]
[0] INFO:__main__:272 Running virtual casing
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 5.78616576e-04  3.15527722e-04  6.18664786e-05  1.39216451e-03
 -7.22050644e-04 -1.08641952e-03  4.83292586e-04]
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.0040566   0.00695468 -0.00562457  0.00010208 -0.00826756 -0.01066438
 -0.01157828  0.00094745]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000030.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000021.nc
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4880870046475565
[0] INFO:root:288 J_stage_1=0.4880870046475565
[0] INFO:root:289 J_stage_2=0.17871564477909635
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0000000e+00 -5.8835455e-06  0.0000000e+00  1.0000000e-06
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4878160881180836
[1] INFO:root:288 J_stage_1=0.4878160881180836
[1] INFO:root:289 J_stage_2=0.17874207739831804
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.16395432e-05  0.00000000e+00  1.43882062e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000031.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000022.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.48782583834237064
[0] INFO:root:288 J_stage_1=0.48782583834237064
[0] INFO:root:289 J_stage_2=0.17874029371801098
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0000000e-06
  0.0000000e+00  5.2156675e-06  0.0000000e+00  0.0000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4878402479129998
[1] INFO:root:288 J_stage_1=0.4878402479129998
[1] INFO:root:289 J_stage_2=0.17874454825382236
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.43882062e-05  0.00000000e+00
  1.10482387e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000032.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000023.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4881135061880068
[0] INFO:root:288 J_stage_1=0.4881135061880068
[0] INFO:root:289 J_stage_2=0.17874882658290223
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -5.2156675e-06  0.0000000e+00  1.0000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000033.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.48772608869852013
[1] INFO:root:288 J_stage_1=0.48772608869852013
[1] INFO:root:289 J_stage_2=0.1787533771380506
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.10482387e-05  0.00000000e+00  1.49572323e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000024.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 47
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4878162296287062
[0] INFO:root:288 J_stage_1=0.4878162296287062
[0] INFO:root:289 J_stage_2=0.17874159148663682
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.48709097632288667
[1] INFO:root:288 J_stage_1=0.48709097632288667
[1] INFO:root:289 J_stage_2=0.17876240953213565
[0] INFO:root:336 grad_with_respect_to_coils=[-1.08228647e-01 -5.87888520e-02 -1.05235602e-02 -1.02334377e-01
  1.26271437e-01  8.44955828e-02 -8.58105877e-02  4.03305871e-02
  3.62814849e-02  4.33414809e-02  3.82701816e-02 -1.07919086e-01
 -4.82106812e-02  2.24275016e-02  2.70737119e-03  7.28164269e-03
  2.41251789e-02 -1.42628850e-02  1.95894068e-03 -4.10309492e-01
  1.22734206e-01  1.02958473e-01  9.38523675e-02 -2.75848254e-02
 -9.57099332e-03 -2.09189961e-02 -1.15629145e-02  1.94814711e-02
 -2.70820115e-02 -2.21247988e-02 -5.29167714e-03  7.79121769e-03
  4.72292504e-02  8.96216889e-02  1.18980530e-01  7.77406829e-03
 -3.29966943e-03  2.80064882e-02  3.45953352e-03 -3.71628808e-03
 -8.75200776e-02  1.26399898e-02  1.77973465e-02 -2.03014988e-03
  5.80761222e-03  3.25187972e-03 -5.00485715e-03 -2.26032040e-02
 -2.05643094e-01  2.33223408e-01  7.42530095e-02 -3.45508677e-02
 -3.11672619e-01 -9.12810121e-02  6.54055977e-02  2.48622422e-02
 -5.25903151e-02 -1.94462616e-02 -4.75680647e-02 -1.33794462e-02
  1.36798590e-02  3.57556287e-03  1.56015543e-02 -1.36955971e-01
 -5.62372312e-01  1.70747770e-01  1.35140531e-01  3.50720524e-01
 -9.08073146e-03 -8.83185313e-02  5.88988739e-02  1.65468270e-02
  6.76666621e-03 -1.94766293e-02 -3.21282979e-02 -3.07701560e-03
  4.71755638e-03  6.54142101e-03  3.95344447e-01  7.67921016e-02
 -1.18156818e-01 -1.56842854e-01  1.14079416e-01  3.04580330e-02
  4.00624565e-02 -1.01426408e-01 -1.08334686e-01 -4.11986087e-02
  6.40743252e-02  3.41826136e-02  1.54320165e-02 -9.78829085e-03
 -1.01190829e-02  4.43480252e-02  3.41938590e-01 -1.82549985e-02
  2.02030720e-01 -5.21354777e-01 -1.95093734e-01 -9.04673086e-02
  6.19552883e-02 -1.40770132e-01 -3.43176583e-02 -8.60642770e-03
  1.87390637e-04  7.49511855e-03  2.85489585e-02 -3.63245261e-02
 -6.39056830e-02 -5.54188039e-01 -2.08186533e-02 -1.93877949e-01
  3.90414843e-01  7.15993424e-02 -9.97737849e-02 -2.38801539e-02
  5.89840224e-02  2.14534466e-02  4.29990980e-02  7.88332941e-02
 -3.66299402e-02 -1.46231909e-02 -5.17688322e-02  5.65529107e-01
  1.67104329e-01 -1.17157638e-01 -3.56299189e-01  4.85297574e-02
 -1.26256878e-01  1.30061989e-01  7.89220452e-02 -2.01303284e-02
 -5.12675524e-02 -9.06572617e-02 -7.64540845e-02  6.48252835e-03
 -2.02468069e-03  1.48617046e-02  3.30950630e-01  4.38961500e-01
  5.86971258e-03  5.23465602e-01 -4.35214174e-01 -8.09698974e-02
 -2.77730102e-01  1.16195517e-01 -9.89557896e-03  1.96486442e-02
 -9.88638477e-03  5.65039798e-02 -2.74084503e-02  4.52500771e-03
  2.19199769e-02  2.69854352e-01 -5.06553523e-01 -5.07905716e-02
 -5.44297057e-01 -3.12134130e-04 -7.79768305e-03 -1.15456787e-01
 -5.35375550e-02  5.11762419e-02 -9.89424260e-03  6.95319525e-03
 -1.24562847e-03  8.03890026e-02  2.23443812e-02  2.91638835e-02
  3.40165153e-01  3.20698195e-01 -3.32376724e-02 -5.07078056e-01
 -1.39391743e-03 -2.65710700e-01  2.73731654e-02 -7.92740734e-02
  7.13030608e-02  6.36547725e-02 -1.71660832e-02  3.87035942e-02
 -4.69499141e-02  1.78327186e-02 -4.23323382e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[  4.63127469  50.71598959   5.59740188  61.872466    -2.24413669
  68.65337496 -43.51565351  53.56152096]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11555476 -0.05683964  0.14439164  0.00601006  0.10873027  0.04924591
  0.14815192  0.00564958]
[0] INFO:__main__:299 True coils dofs = [ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.39668149e-04  7.58827185e-05  1.49146883e-05  3.00235813e-04
 -1.71476366e-04 -2.27204676e-04  1.12834516e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-8.40671890e-04  1.99581269e-03  5.09581084e-04  5.99731127e-05
 -1.75211295e-03 -2.91076611e-03 -1.42040472e-03  1.89336052e-04]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000034.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4856779182257557
[0] INFO:root:288 J_stage_1=0.4856779182257557
[0] INFO:root:289 J_stage_2=0.1566917251952455
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.6423696434210011 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:__main__:333 True vmec dofs = [ 0.11555476 -0.05683964  0.14439164  0.00601006  0.10873027  0.04924591
  0.14815192  0.00564958]
[0] INFO:__main__:334 True JF.x = [ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11555476 -0.05683964  0.14439164  0.00601006  0.10873027  0.04924591
  0.14815192  0.00564958]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11555476 -0.05683964  0.14439164  0.00601006  0.10873027  0.04924591
  0.14815192  0.00564958]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4856779182257557
[0] INFO:root:288 J_stage_1=0.4856779182257557
[0] INFO:root:289 J_stage_2=0.1566917251952455
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:262 JF.x=[ 1.13329539e+00  1.15931153e+00  1.18967403e+00  1.12143899e+00
  5.87258232e-04  3.95160993e-01 -9.79612587e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 5.68396423e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.39668149e-04  7.58827185e-05  1.49146883e-05  3.00235813e-04
 -1.71476366e-04 -2.27204676e-04  1.12834516e-04]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-8.29116414e-04  1.99581269e-03  5.09581084e-04  5.99731127e-05
 -1.75211295e-03 -2.91076611e-03 -1.43536195e-03  1.90336052e-04]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000025.nc
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000035.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4859946203147569
[0] INFO:root:288 J_stage_1=0.4859946203147569
[0] INFO:root:289 J_stage_2=0.15666606185522614
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -5.68396423e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.48573733897815347
[1] INFO:root:288 J_stage_1=0.48573733897815347
[1] INFO:root:289 J_stage_2=0.15668983427683167
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.15554760e-05  0.00000000e+00  1.44391643e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000036.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000026.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.48574245892073026
[0] INFO:root:288 J_stage_1=0.48574245892073026
[0] INFO:root:289 J_stage_2=0.15668804239433853
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  4.92459089e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4857776122794294
[1] INFO:root:288 J_stage_1=0.4857776122794294
[1] INFO:root:289 J_stage_2=0.15669083401091838
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.44391643e-05  0.00000000e+00
  1.08730274e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000037.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000027.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4860027356251991
[0] INFO:root:288 J_stage_1=0.4860027356251991
[0] INFO:root:289 J_stage_2=0.1566944442854898
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -4.92459089e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4856364127226835
[1] INFO:root:288 J_stage_1=0.4856364127226835
[1] INFO:root:289 J_stage_2=0.1566964385745011
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.08730274e-05  0.00000000e+00  1.48151919e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000038.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000028.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 48
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.48573361931221215
[0] INFO:root:288 J_stage_1=0.48573361931221215
[0] INFO:root:289 J_stage_2=0.156689448188718
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.48505121775884685
[1] INFO:root:288 J_stage_1=0.48505121775884685
[1] INFO:root:289 J_stage_2=0.1567103626826135
[0] INFO:root:336 grad_with_respect_to_coils=[-1.12681380e-01 -5.99415038e-02 -1.05179640e-02 -6.01434584e-02
  1.24980956e-01  5.15408616e-02 -8.42962534e-02  4.53448698e-02
  3.66969518e-02  3.89736248e-02  3.17456060e-02 -1.01285335e-01
 -3.88309982e-02  1.89754388e-02  1.60009107e-03  6.97033065e-03
  1.96582211e-02 -1.38163047e-02  2.09318058e-02 -3.37861969e-01
  1.09586031e-01  4.39404223e-02  6.96550297e-02 -1.02910738e-02
 -2.84147479e-04 -2.20777283e-02 -1.74502811e-02  1.76840074e-02
 -1.91934151e-02 -1.82045174e-02 -5.79835933e-03  5.63216074e-03
  4.08659196e-02  6.02663066e-02  1.00360359e-01  1.50097925e-02
  1.76109198e-02  3.76749966e-02 -1.26755502e-02 -1.27445702e-02
 -7.70009664e-02  1.02831856e-02  1.16124973e-02 -1.40191413e-03
  8.13395373e-03  1.10552259e-03 -6.67942973e-03 -1.93154236e-02
 -1.48667911e-01  2.58584318e-01  3.37083214e-02 -6.64672653e-02
 -2.57827843e-01 -6.63507984e-02  6.72067538e-02  3.25408131e-02
 -5.92900293e-02 -2.02737442e-02 -4.20080354e-02 -1.15915020e-02
  1.11799097e-02  3.99306647e-03  1.27524616e-02 -9.36952267e-02
 -5.01033192e-01  1.65362262e-01  8.99488073e-02  2.84773053e-01
  1.46278630e-03 -6.70596016e-02  5.72292298e-02  9.96215345e-03
  1.81387360e-03 -1.64568862e-02 -2.96387278e-02  6.86677864e-04
  7.92318245e-03  5.85879886e-03  3.22790054e-01  5.04848755e-02
 -8.58099730e-02 -1.33489417e-01  1.27230233e-01  2.76643781e-02
  1.51818173e-02 -9.34153214e-02 -1.02190314e-01 -3.54834427e-02
  5.40441523e-02  2.98435199e-02  1.45432729e-02 -1.08894002e-02
 -8.36121067e-03  7.51006558e-02  3.76287496e-01 -4.55378342e-02
  1.52839699e-01 -4.90475336e-01 -1.87489551e-01 -7.26554503e-02
  8.05210909e-02 -1.23117849e-01 -3.49794022e-02 -1.77025071e-02
 -1.50544490e-03  1.32396829e-02  3.28072923e-02 -3.46914467e-02
 -4.02189657e-02 -5.24210777e-01 -1.81919092e-02 -1.85022591e-01
  3.53938970e-01  6.42947959e-02 -8.39117623e-02 -1.56267269e-02
  5.33527395e-02  2.02970898e-02  3.69809162e-02  7.52846963e-02
 -3.18629078e-02 -1.43497800e-02 -5.31608314e-02  4.88145109e-01
  9.03539049e-02 -8.46721754e-02 -3.22200668e-01  5.39393767e-02
 -1.12108784e-01  1.26122282e-01  8.16926636e-02 -3.14166055e-02
 -5.17849451e-02 -9.10940204e-02 -7.09645182e-02  8.30497397e-03
 -2.61887725e-03  1.13666450e-02  3.40564919e-01  4.58469716e-01
 -2.37325066e-03  4.88563449e-01 -4.25173623e-01 -8.65190727e-02
 -2.69681678e-01  1.10175603e-01  1.27096783e-02  2.85868697e-02
 -4.08333651e-03  5.10774748e-02 -3.02293158e-02  3.98676411e-03
  2.30804094e-02  2.74213880e-01 -4.95702446e-01 -5.03741762e-02
 -5.19905960e-01 -2.95914529e-03 -1.29394072e-02 -1.12441476e-01
 -4.10671459e-02  5.95626124e-02 -3.36543631e-03  1.03411777e-02
 -5.86523476e-03  7.43292568e-02  2.39551958e-02  3.13355423e-02
  3.00449427e-01  2.01591887e-01 -1.87582322e-02 -4.61279873e-01
  2.47186793e-03 -2.54845295e-01  3.00654228e-02 -5.78755730e-02
  6.24658901e-02  6.88425908e-02 -2.32038003e-02  3.36019737e-02
 -4.10079928e-02  2.03066853e-02 -4.31651596e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[  4.97857758  51.20348004   6.84269998  60.85789407  -3.38379758
  66.5103959  -41.04320657  53.42407993]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11256435 -0.05537624  0.14805806  0.00589033  0.10946641  0.04487897
  0.1421717   0.00445847]
[0] INFO:__main__:299 True coils dofs = [ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 3.93426180e-04  2.07268255e-04  3.99339500e-05  4.67871184e-04
 -4.49979410e-04 -3.58717938e-04  2.71472517e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00299041  0.0014634   0.00366642 -0.00011973  0.00073613 -0.00436693
 -0.00598022 -0.00119211]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000039.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4668105660819825
[0] INFO:root:288 J_stage_1=0.4668105660819825
[0] INFO:root:289 J_stage_2=0.1319358789976301
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.5987464450796126 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:__main__:333 True vmec dofs = [ 0.11256435 -0.05537624  0.14805806  0.00589033  0.10946641  0.04487897
  0.1421717   0.00445847]
[0] INFO:__main__:334 True JF.x = [ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11256435 -0.05537624  0.14805806  0.00589033  0.10946641  0.04487897
  0.1421717   0.00445847]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11256435 -0.05537624  0.14805806  0.00589033  0.10946641  0.04487897
  0.1421717   0.00445847]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4668105660819825
[0] INFO:root:288 J_stage_1=0.4668105660819825
[0] INFO:root:289 J_stage_2=0.1319358789976301
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:262 JF.x=[ 1.13343506e+00  1.15938742e+00  1.18968895e+00  1.12173923e+00
  4.15781866e-04  3.94933788e-01 -9.68329135e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 5.53762415e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 3.93426180e-04  2.07268255e-04  3.99339500e-05  4.67871184e-04
 -4.49979410e-04 -3.58717938e-04  2.71472517e-04]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00297915  0.0014634   0.00366642 -0.00011973  0.00073613 -0.00436693
 -0.00599504 -0.00119111]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000040.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000029.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.467059270768643
[0] INFO:root:288 J_stage_1=0.467059270768643
[0] INFO:root:289 J_stage_2=0.1319129402606884
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -5.53762415e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4668634001170099
[1] INFO:root:288 J_stage_1=0.4668634001170099
[1] INFO:root:289 J_stage_2=0.13192798863037317
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.12564350e-05  0.00000000e+00  1.48058064e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000041.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000030.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.46686327563380153
[0] INFO:root:288 J_stage_1=0.46686327563380153
[0] INFO:root:289 J_stage_2=0.13193263771376412
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  4.48789744e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.46685947943921535
[1] INFO:root:288 J_stage_1=0.46685947943921535
[1] INFO:root:289 J_stage_2=0.13193450525799078
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.48058064e-05  0.00000000e+00
  1.09466406e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000042.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000031.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.46706321287743474
[0] INFO:root:288 J_stage_1=0.46706321287743474
[0] INFO:root:289 J_stage_2=0.13193571653376981
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -4.48789744e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4667633699408006
[1] INFO:root:288 J_stage_1=0.4667633699408006
[1] INFO:root:289 J_stage_2=0.1319440003018758
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.09466406e-05  0.00000000e+00  1.42171698e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000043.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000032.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 49
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.46685878216419585
[0] INFO:root:288 J_stage_1=0.46685878216419585
[0] INFO:root:289 J_stage_2=0.13193325495307912
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4662557328695938
[1] INFO:root:288 J_stage_1=0.4662557328695938
[1] INFO:root:289 J_stage_2=0.1319533436853855
[0] INFO:root:336 grad_with_respect_to_coils=[-1.29142996e-01 -6.77316815e-02 -1.37363252e-02  4.66853084e-02
  1.33663912e-01 -4.11819939e-02 -8.01641001e-02  1.22784439e-01
  4.20148361e-02  3.94846117e-03  2.32551633e-02 -9.66234490e-02
 -3.70190783e-02  2.41863371e-02  9.64964281e-03 -2.57555723e-03
  8.70604312e-03 -7.36689675e-03  4.04593645e-02 -3.40393124e-01
  1.48772982e-01  4.89075339e-02  5.30202535e-02 -2.67856463e-02
 -9.43256086e-03 -1.82314223e-02 -1.31416549e-02  2.15651760e-02
 -1.18641951e-02 -2.19788108e-02 -9.94428425e-03  8.87030053e-03
  4.07162236e-02  7.28038644e-02  1.19009169e-01  1.44465086e-02
  1.91935329e-02  4.66788242e-02 -1.77096028e-02 -1.16075588e-02
 -8.63163293e-02  7.18389052e-03  1.92724271e-02 -2.83523406e-03
  4.40156641e-03 -4.50256665e-04 -5.42374483e-03 -1.38462896e-02
 -7.86390968e-02  2.85033689e-01 -7.48579724e-02 -1.05755867e-01
 -1.46492721e-01 -3.68346614e-03  2.81289988e-02  3.17535048e-03
 -7.93329399e-02 -1.77393743e-02 -1.18075295e-02  6.70542283e-03
 -7.03399598e-03 -1.20461409e-02  8.14255574e-03 -7.78424553e-02
 -4.76249283e-01  2.20929278e-01  9.80885692e-02  2.22286502e-01
 -5.63955049e-03 -6.00457481e-02  5.23722371e-02  1.31239929e-02
 -3.27155763e-04 -1.12056443e-02 -2.53376633e-02  1.90140678e-03
  9.93452813e-03  6.24595969e-03  3.56393149e-01  8.05555532e-02
 -7.24145997e-02 -1.56488183e-01  1.10442985e-01  3.25335620e-02
  8.72249713e-03 -1.11530409e-01 -9.84105878e-02 -7.64064488e-03
  5.90402058e-02  1.41499470e-02 -5.89062475e-03 -9.54706709e-03
  6.33697238e-03  9.27693584e-02  3.70833649e-01 -1.35718980e-01
  8.16117020e-02 -4.23979573e-01 -1.29774010e-01 -5.02200294e-02
  9.08047699e-02 -1.38599102e-01 -4.69792078e-02 -2.60600456e-02
  5.88897750e-03  2.13252549e-02  3.71095681e-02 -4.37017189e-02
 -4.71757150e-02 -4.63620738e-01  1.36121102e-02 -1.26332990e-01
  3.12895293e-01  4.51511730e-02 -7.87484336e-02 -1.45321379e-02
  4.23021359e-02  7.87668622e-03  3.65980996e-02  8.01214414e-02
 -2.29881331e-02 -1.65832024e-02 -5.92916335e-02  4.80400302e-01
  7.90107824e-02 -5.57135682e-02 -3.14607356e-01  1.89655248e-02
 -1.10318401e-01  1.46382425e-01  7.50861272e-02 -5.45561268e-02
 -6.32654986e-02 -7.31934804e-02 -5.53384262e-02  8.43705491e-04
 -1.29115288e-02  9.16679158e-03  2.86959487e-01  4.01903981e-01
 -9.36336340e-02  3.84545256e-01 -3.53381500e-01 -6.20000050e-02
 -1.96143509e-01  1.07209935e-01 -1.00392590e-01 -1.04017273e-01
  4.99341995e-02  8.00468839e-02  1.92243743e-01  1.24249667e-01
 -8.10260013e-02  2.23022953e-01 -4.15641872e-01 -9.08828866e-02
 -4.13818576e-01  1.90856124e-02  1.11439802e-02 -8.62769150e-02
 -1.03095178e-01  2.62234312e-02  2.87043381e-02 -8.66176114e-02
  7.63162550e-02  9.07485574e-03 -2.78093321e-02  8.89094231e-02
  2.76728696e-01  1.24204758e-01 -1.86068619e-03 -4.23213594e-01
 -8.61790068e-04 -2.07585990e-01  1.22746493e-02 -1.05574226e-01
  5.15993343e-02 -2.47014245e-03  1.73497557e-02  1.57557338e-01
 -1.60304920e-01 -4.19508938e-03 -4.05391909e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[  3.99270886  40.76946059   3.21087661  49.46826795  -3.56957338
  56.25893522 -37.79715189  45.59203766]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11736271 -0.04677151  0.15089994  0.00166232  0.11758889  0.03998657
  0.13413853 -0.00023094]
[0] INFO:__main__:299 True coils dofs = [ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.00174848  0.00088732  0.00020247 -0.00136669 -0.00183991  0.00139216
  0.00082484]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00479836  0.00860473  0.00284187 -0.00422801  0.00812248 -0.00489241
 -0.00803317 -0.00469042]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000044.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.45049875845856946
[0] INFO:root:288 J_stage_1=0.45049875845856946
[0] INFO:root:289 J_stage_2=0.09864604184262667
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.5491448003011962 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:__main__:333 True vmec dofs = [ 0.11736271 -0.04677151  0.15089994  0.00166232  0.11758889  0.03998657
  0.13413853 -0.00023094]
[0] INFO:__main__:334 True JF.x = [ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11736271 -0.04677151  0.15089994  0.00166232  0.11758889  0.03998657
  0.13413853 -0.00023094]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11736271 -0.04677151  0.15089994  0.00166232  0.11758889  0.03998657
  0.13413853 -0.00023094]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.45049875845856946
[0] INFO:root:288 J_stage_1=0.45049875845856946
[0] INFO:root:289 J_stage_2=0.09864604184262667
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:262 JF.x=[ 1.13382849e+00  1.15959468e+00  1.18972888e+00  1.12220710e+00
 -3.41975439e-05  3.94575070e-01 -9.41181883e-03]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 4.67715088e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.00174848  0.00088732  0.00020247 -0.00136669 -0.00183991  0.00139216
  0.00082484]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0048101   0.00860473  0.00284187 -0.00422801  0.00812248 -0.00489241
 -0.00804738 -0.00468942]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000045.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000033.nc
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4506216037964629
[0] INFO:root:288 J_stage_1=0.4506216037964629
[0] INFO:root:289 J_stage_2=0.09863200737266876
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -4.67715088e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4505531104617832
[1] INFO:root:288 J_stage_1=0.4505531104617832
[1] INFO:root:289 J_stage_2=0.09865325746115866
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.17362710e-05  0.00000000e+00  1.50899938e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000046.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000034.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4505331072965109
[0] INFO:root:288 J_stage_1=0.4505331072965109
[0] INFO:root:289 J_stage_2=0.09864309628921568
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  3.99865677e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.45043067024293765
[1] INFO:root:288 J_stage_1=0.45043067024293765
[1] INFO:root:289 J_stage_2=0.09864516328333311
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.50899938e-05  0.00000000e+00
  1.17588888e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000047.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000035.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4506423010853886
[0] INFO:root:288 J_stage_1=0.4506423010853886
[0] INFO:root:289 J_stage_2=0.09864187776730467
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -3.99865677e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4504373706143066
[1] INFO:root:288 J_stage_1=0.4504373706143066
[1] INFO:root:289 J_stage_2=0.09866382423765586
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.17588888e-05  0.00000000e+00  1.34138530e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000048.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000036.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4505289904511755
[0] INFO:root:288 J_stage_1=0.4505289904511755
[0] INFO:root:289 J_stage_2=0.09864338090955083
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4500412889581946
[1] INFO:root:288 J_stage_1=0.4500412889581946
[1] INFO:root:289 J_stage_2=0.09866374040532187
[0] INFO:root:336 grad_with_respect_to_coils=[-8.16813256e-02 -4.40993908e-02 -1.00744458e-02 -2.19961216e-01
  1.09111683e-01  7.72498853e-02 -2.76722836e-02  6.16649250e-02
  3.67947346e-02 -4.68590225e-02  8.30011006e-04 -4.49649410e-02
 -1.09242924e-03 -5.50233538e-03 -1.66663300e-02  6.72692150e-03
  1.54548103e-02 -2.83422581e-03  2.09266882e-02 -3.10389969e-01
  1.63856621e-02 -2.34095621e-02 -1.08083421e-03  6.41531588e-03
  3.57777003e-02 -1.32324401e-02 -1.19349489e-02  9.34470271e-03
 -9.20459844e-03 -1.28712811e-02 -1.08320836e-02  5.21585389e-03
  2.68269456e-02  9.73056855e-02  1.31105560e-01  1.47904975e-02
 -4.93215147e-03 -1.13288546e-02 -4.42807568e-02 -2.73614225e-02
 -4.90527448e-02  4.00027082e-03 -2.80200566e-03 -1.10760764e-02
  3.67651979e-03  1.52993210e-02 -9.22478757e-05 -2.05053895e-02
 -1.53787649e-01  1.76140829e-01  1.22598952e-01 -4.08512505e-02
 -3.77635403e-02  1.08098475e-01 -1.14968771e-02 -3.61792892e-02
 -3.63672897e-02  2.98594128e-02 -1.20446751e-02 -6.45173858e-03
 -1.97801328e-02 -8.49925513e-04  3.60466388e-04 -1.99438472e-02
 -2.58539034e-01  7.79531596e-02  2.47062822e-02  3.86373391e-02
 -2.76134426e-02 -1.91490828e-02  3.73627274e-02 -3.39172618e-03
  4.69492022e-03  1.46891445e-02 -1.10676981e-02  1.19823056e-02
  1.59785459e-02 -7.62134236e-03  3.24466414e-01  1.22289972e-01
 -6.64478219e-02 -2.29261483e-02  6.42055936e-02 -1.26294023e-02
 -8.47066878e-02 -6.00824518e-02 -3.38809856e-02  1.36509800e-02
 -1.93296604e-03  5.56655054e-03 -5.90430282e-03 -2.61975702e-02
  7.77985341e-03  1.64823905e-02  6.78798776e-02 -1.81999483e-01
  8.11809350e-02 -7.42741711e-02  1.04600080e-01  1.05803312e-01
 -4.61748107e-01 -9.41134559e-02  5.95925210e-01  6.53322012e-01
  8.40192442e-01 -1.10441057e+00 -1.22796141e+00  1.61818130e-01
 -1.03813850e-02 -2.23655443e-01 -2.57895921e-01 -3.59616176e-02
  2.84636638e-01  2.05131838e-01 -1.06341399e-01  8.46008842e-02
  5.28529002e-02 -5.17029166e-01 -1.97485022e-01 -5.96522844e-01
  3.90482193e-01  5.98159742e-01  3.72916535e-01  3.67313951e-01
 -7.08240843e-02 -1.41586016e-01 -5.68963811e-02  1.25625802e-01
 -5.94337450e-02 -2.92219092e-01 -4.20104200e-01  3.63232285e-01
  5.70097529e-01  4.87511751e-01 -6.70003032e-02 -6.20002516e-01
 -2.12241968e-01 -1.12357851e-01  1.32579239e-01  1.04584707e-01
 -2.81003356e-03  2.74149403e-01 -1.86474211e-01 -1.09927702e-01
 -1.02840515e-01  6.98902129e-02  2.56282998e-02  4.34693162e-02
  2.25500803e-02  4.73480203e-02 -2.05246826e-02 -1.50643416e-02
  8.88052665e-03  1.13367635e-01 -1.26179446e-01 -4.44014386e-02
 -2.38832613e-01  6.76836817e-02  1.37052040e-02 -7.31533473e-02
 -3.24671607e-02  4.63630284e-02  2.83584938e-02  2.37556729e-03
  4.85688260e-03  3.35110071e-02  6.84761386e-05  1.62869655e-02
  2.00603937e-01  2.45308882e-01 -2.41982311e-02 -2.72384027e-01
  1.81139525e-02 -6.78245673e-02 -5.13924379e-02 -6.56116517e-02
  2.21754526e-02  1.97198654e-02  9.97409318e-03  3.29001768e-02
 -2.65009424e-03  1.83511257e-02 -1.89801879e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[  5.24592706  23.26434846  -4.5703647   31.40328453  -3.70829676
  34.85634291 -32.78483358  27.57105953]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11732304 -0.04004787  0.15470718 -0.00581982  0.12147266  0.04435109
  0.13005921 -0.00774632]
[0] INFO:__main__:299 True coils dofs = [ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.00244147  0.00124353  0.00028507 -0.00014499 -0.00279582  0.00104791
  0.0010669 ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-3.96666359e-05  6.72363722e-03  3.80724133e-03 -7.48214270e-03
  3.88377379e-03  4.36452318e-03 -4.07931640e-03 -7.51638101e-03]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000049.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4087546673809541
[0] INFO:root:288 J_stage_1=0.4087546673809541
[0] INFO:root:289 J_stage_2=0.12885635297366899
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.5376110203546232 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:__main__:333 True vmec dofs = [ 0.11732304 -0.04004787  0.15470718 -0.00581982  0.12147266  0.04435109
  0.13005921 -0.00774632]
[0] INFO:__main__:334 True JF.x = [ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11732304 -0.04004787  0.15470718 -0.00581982  0.12147266  0.04435109
  0.13005921 -0.00774632]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11732304 -0.04004787  0.15470718 -0.00581982  0.12147266  0.04435109
  0.13005921 -0.00774632]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4087546673809541
[0] INFO:root:288 J_stage_1=0.4087546673809541
[0] INFO:root:289 J_stage_2=0.12885635297366899
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:262 JF.x=[ 1.13557697  1.160482    1.18993135  1.1208404  -0.00187411  0.39596723
 -0.00858698]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 4.00478716e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.00244147  0.00124353  0.00028507 -0.00014499 -0.00279582  0.00104791
  0.0010669 ]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-2.79343315e-05  6.72363722e-03  3.80724133e-03 -7.48214270e-03
  3.88377379e-03  4.36452318e-03 -4.09273025e-03 -7.51538101e-03]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000050.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000037.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.40880173824089555
[0] INFO:root:288 J_stage_1=0.40880173824089555
[0] INFO:root:289 J_stage_2=0.12884835931104013
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -4.00478716e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.40876605049450243
[1] INFO:root:288 J_stage_1=0.40876605049450243
[1] INFO:root:289 J_stage_2=0.12887343539949436
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.17323044e-05  0.00000000e+00  1.54707179e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000051.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000038.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.40876719024454317
[0] INFO:root:288 J_stage_1=0.40876719024454317
[0] INFO:root:289 J_stage_2=0.12885335461424482
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  4.43510909e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4086259930081326
[1] INFO:root:288 J_stage_1=0.4086259930081326
[1] INFO:root:289 J_stage_2=0.12885642305099293
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.54707179e-05  0.00000000e+00
  1.21472662e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000052.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000039.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4088389641035768
[0] INFO:root:288 J_stage_1=0.4088389641035768
[0] INFO:root:289 J_stage_2=0.1288491256418082
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -4.43510909e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.40872957265516724
[1] INFO:root:288 J_stage_1=0.40872957265516724
[1] INFO:root:289 J_stage_2=0.1288666962722827
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.21472662e-05  0.00000000e+00  1.30059213e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000053.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000040.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4087761775997234
[0] INFO:root:288 J_stage_1=0.4087761775997234
[0] INFO:root:289 J_stage_2=0.1288537025635049
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4083847576871594
[1] INFO:root:288 J_stage_1=0.4083847576871594
[1] INFO:root:289 J_stage_2=0.12887880267789847
[0] INFO:root:336 grad_with_respect_to_coils=[-5.16722974e-02 -2.20775167e-02 -1.92162825e-03 -3.67918608e-01
  7.05702170e-02  1.69367891e-01  1.32483602e-03 -6.31031104e-03
  2.57319006e-02 -7.51239214e-02 -2.03693314e-02  2.24569059e-02
  3.88422373e-02 -4.19623727e-02 -4.79906057e-02  2.48991418e-02
  2.75839591e-02 -4.85088989e-03  4.53031060e-02 -1.36519277e-01
 -9.92820330e-02 -1.20988889e-01 -5.99041034e-02  6.80716345e-02
  8.67403085e-02 -1.54632752e-02 -3.12278331e-02 -1.00313185e-02
  3.50640113e-03  7.98510365e-03 -6.93883456e-03 -6.58799927e-03
  4.08693058e-03  5.97204853e-02  9.51250413e-02  2.52620296e-02
  2.87247356e-03 -4.48414966e-02 -7.21981138e-02 -4.29208846e-02
  9.61158381e-03  9.12950241e-03 -2.60979066e-02 -1.56230803e-02
  6.56010916e-03  2.37600862e-02  4.26081246e-03 -2.06607794e-02
 -1.17752430e-01  7.22045837e-02  1.57749735e-01 -3.25757326e-02
  1.25668488e-01  2.90113311e-01 -3.85869024e-02 -9.57168655e-02
  8.74706931e-02  6.87654613e-02 -1.75423436e-01 -2.23448512e-01
  1.18104238e-01  3.91804032e-01 -2.56067916e-01  1.59191923e-01
  1.62479744e-02 -1.06899956e-01 -1.48390927e-01 -1.54174899e-01
  6.01912607e-02  7.40800755e-02  6.50747569e-02 -2.07851678e-01
 -3.32627331e-02  2.53561308e-01  8.73211663e-02  7.46122899e-02
  1.25898693e-01  4.18435150e-02  1.14510130e-01 -3.23125161e-02
 -2.62772786e-02  2.30126340e-01  7.89532858e-02 -2.55936386e-01
 -2.08348532e-01  2.88917413e-01  2.82820403e-01  7.94551054e-02
 -4.23025652e-01 -6.28250685e-02  1.62969266e-01 -1.38682172e-01
 -7.82185779e-02  3.24311892e-02  4.58987359e-02  4.55214492e-02
 -5.52504658e-02 -6.88043448e-02 -1.08940464e-03  2.72462027e-01
  1.20404853e-01 -2.31836145e-03 -6.50430508e-02 -1.95039848e-01
 -2.68303470e-01  4.62250862e-01  9.27371889e-01  2.70204205e-01
  6.07837378e-02 -2.08481745e-02 -3.77351211e-02 -5.52292361e-03
 -1.13598077e-02  1.28445132e-03  1.72482022e-02  1.48250683e-01
  1.03415493e-01 -2.70705981e-02 -5.93051385e-02 -6.14243038e-02
 -2.18262278e-01 -5.01321858e-01 -8.36595423e-02  1.04676186e-01
 -1.22676788e-02 -7.11921441e-02  4.87752462e-02  1.32650051e-01
 -4.52975099e-02 -2.72343533e-01 -7.46054505e-02  1.89076412e-01
  9.73818154e-02  4.19416480e-02 -1.46958606e-01  2.13812608e-01
  2.76465933e-01  7.12267207e-02  6.81651791e-02 -2.24568677e-01
 -5.74704285e-01 -7.50042750e-02 -2.27376330e-01 -6.65500803e-01
 -1.97591331e-01  1.73651444e-03  1.46255136e+00  2.58967165e+00
 -4.82417268e-01 -2.38824573e+00 -6.37814415e+00 -7.95457039e+00
  4.71237250e+00  5.34962525e-02  2.17927240e-01 -9.40759547e-01
 -5.80116789e-01 -3.07217062e-01 -3.84027485e-01  2.51894353e-01
  4.68546870e-01  1.50558692e+00  1.74147015e-01  7.20790014e-01
 -1.74431582e+00 -6.06124828e-01  2.70875926e+00 -5.43051002e+00
  5.58178907e-02 -3.87419083e-01 -1.68571995e-01 -4.00060350e-01
  5.18013943e-03  1.05541477e+00 -5.56886716e-01  1.18744448e+00
 -5.92011127e-01 -8.61307315e-01 -4.61986336e-01 -3.58535974e+00
  2.43228446e+00  2.52770780e-01  3.07969787e+00]
[0] INFO:root:337 grad_with_respect_to_surface=[  2.42625306   9.7576215   -8.31275549   9.52450416  -1.21438248
  17.37711277 -26.71552291  18.85980861]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11734597 -0.04393376  0.1525068  -0.00149555  0.11922805  0.04182864
  0.13241683 -0.00340285]
[0] INFO:__main__:299 True coils dofs = [ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[-1.41103534e-03 -7.18691442e-04 -1.64752104e-04  8.37951784e-05
  1.61582973e-03 -6.05633940e-04 -6.16607277e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 2.29251355e-05 -3.88589279e-03 -2.20037625e-03  4.32426727e-03
 -2.24460780e-03 -2.52245453e-03  2.35762068e-03  4.34247718e-03]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000054.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4296785326409204
[0] INFO:root:288 J_stage_1=0.4296785326409204
[0] INFO:root:289 J_stage_2=0.0921931424163912
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.5218716750573116 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:__main__:333 True vmec dofs = [ 0.11734597 -0.04393376  0.1525068  -0.00149555  0.11922805  0.04182864
  0.13241683 -0.00340285]
[0] INFO:__main__:334 True JF.x = [ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11734597 -0.04393376  0.1525068  -0.00149555  0.11922805  0.04182864
  0.13241683 -0.00340285]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11734597 -0.04393376  0.1525068  -0.00149555  0.11922805  0.04182864
  0.13241683 -0.00340285]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4296785326409204
[0] INFO:root:288 J_stage_1=0.4296785326409204
[0] INFO:root:289 J_stage_2=0.0921931424163912
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:262 JF.x=[ 1.13801844  1.16172553  1.19021641  1.12069541 -0.00466993  0.39701514
 -0.00752008]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 4.39337644e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[-1.41103534e-03 -7.18691442e-04 -1.64752104e-04  8.37951784e-05
  1.61582973e-03 -6.05633940e-04 -6.16607277e-04]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 3.46597324e-05 -3.88589279e-03 -2.20037625e-03  4.32426727e-03
 -2.24460780e-03 -2.52245453e-03  2.34461476e-03  4.34347718e-03]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000055.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000041.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.429764898812814
[0] INFO:root:288 J_stage_1=0.429764898812814
[0] INFO:root:289 J_stage_2=0.09218182865921662
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -4.39337644e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4297216614183935
[1] INFO:root:288 J_stage_1=0.4297216614183935
[1] INFO:root:289 J_stage_2=0.09220446351295733
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.17345969e-05  0.00000000e+00  1.52506803e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000056.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000042.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.42970550220628256
[0] INFO:root:288 J_stage_1=0.42970550220628256
[0] INFO:root:289 J_stage_2=0.09219019136768963
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  4.18286363e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.42958190421583536
[1] INFO:root:288 J_stage_1=0.42958190421583536
[1] INFO:root:289 J_stage_2=0.09219245329741625
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.52506803e-05  0.00000000e+00
  1.19228054e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000057.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000043.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.4297985292072041
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:root:288 J_stage_1=0.4297985292072041
[0] INFO:root:289 J_stage_2=0.09218774783601806
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -4.18286363e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.42962442063729134
[1] INFO:root:288 J_stage_1=0.42962442063729134
[1] INFO:root:289 J_stage_2=0.0922081286236099
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.19228054e-05  0.00000000e+00  1.32416834e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000058.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000044.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.42970403883996905
[0] INFO:root:288 J_stage_1=0.42970403883996905
[0] INFO:root:289 J_stage_2=0.09219048521263025
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.4292547741824412
[1] INFO:root:288 J_stage_1=0.4292547741824412
[1] INFO:root:289 J_stage_2=0.09221261175763176
[0] INFO:root:336 grad_with_respect_to_coils=[-6.86199778e-02 -3.59725721e-02 -7.26575833e-03 -2.79802546e-01
  9.32830627e-02  1.13857790e-01 -1.63716496e-02  3.30262083e-02
  3.26493746e-02 -5.73726048e-02 -8.14301582e-03 -1.85847552e-02
  1.48551982e-02 -1.93619974e-02 -2.85283335e-02  1.36419145e-02
  1.90933410e-02 -3.57738302e-03  2.75284045e-02 -2.38508501e-01
 -3.15428516e-02 -6.33424102e-02 -2.62644620e-02  3.19710432e-02
  5.65906488e-02 -1.50681018e-02 -1.88152108e-02  2.66133480e-03
 -3.95383052e-03 -5.27846131e-03 -9.23227326e-03  1.32827143e-03
  1.67194653e-02  8.24395205e-02  1.15260322e-01  1.77249536e-02
 -1.60532944e-03 -2.46067888e-02 -5.51951882e-02 -3.49849050e-02
 -2.50824759e-02  6.14643623e-03 -1.24185915e-02 -1.27119157e-02
  5.15802779e-03  1.86269960e-02  1.25841503e-03 -2.05019544e-02
 -1.40424015e-01  1.45462867e-01  1.70992282e-01 -5.07931386e-02
  1.02300436e-02  1.51175092e-01 -1.44751949e-02 -5.71376888e-02
 -1.76876229e-02  4.70685006e-02 -7.72973525e-03 -8.50845934e-03
 -2.38825243e-02 -2.91916380e-04 -4.93728675e-03  4.61563985e-02
 -1.38989420e-01  3.62932708e-02 -4.33958284e-02 -4.44341984e-02
 -1.23046072e-02  2.00968336e-02  4.08723029e-02 -3.05152825e-02
 -5.49556074e-03  2.67790573e-02 -2.17356399e-03  2.34349614e-02
  2.27449100e-02 -1.86912457e-02  2.46255803e-01  1.08698415e-01
 -4.52883440e-02  4.36247631e-02  7.30712430e-02 -3.89586606e-02
 -1.31373075e-01 -2.62518049e-02  5.57984713e-03  2.51943379e-02
 -3.74759347e-02  2.04796744e-04  2.09419419e-03 -2.85650864e-02
  5.87957617e-03  2.13915454e-02  9.76046208e-02  3.58352949e-02
  2.56507183e-02 -1.92202282e-01 -2.12226265e-02  1.21658563e-01
  8.95961146e-02 -1.08112735e-01 -3.76944700e-02 -2.39837777e-02
 -5.16485567e-03  4.01754829e-02  6.03549825e-02 -1.03494932e-02
  1.67004959e-02 -1.36711923e-01 -5.98475318e-03 -1.29256845e-02
  1.52885807e-01  1.83353202e-02 -6.45972412e-02 -1.31430770e-03
  2.30672225e-02 -9.20311927e-03  1.60306994e-02  3.39340468e-02
 -9.72846257e-03 -6.10532026e-03 -2.18322406e-02  2.70164895e-01
  9.04415018e-02 -8.50394988e-02 -8.59169575e-02  6.39273509e-02
 -4.36080658e-02 -1.94766158e-02  2.68055835e-02  2.82021903e-02
  1.35623721e-02 -5.14299682e-02 -4.06424358e-02 -1.80985911e-02
 -7.33821200e-03  3.06542115e-03  1.07577338e-01  5.70165810e-02
  5.21872491e-03  1.64831790e-01 -1.36693636e-01 -1.53690245e-01
 -4.97014468e-02  4.93509078e-02  8.63668505e-02  1.78566032e-01
  1.72428689e-02 -1.44580367e-01 -4.28912276e-01 -6.01282572e-01
  2.99737299e-01  8.91882673e-02 -5.92576418e-02 -5.28752188e-02
 -1.54340582e-01  1.67150683e-02 -2.08123768e-02 -2.66008173e-02
 -4.34711516e-02  1.54312518e-01  7.67652657e-02  8.06593303e-03
 -8.31180092e-02 -5.64472394e-02  1.76412477e-01 -3.44145070e-01
  1.47214610e-01  1.84018308e-01 -3.01610410e-02 -2.19920870e-01
  4.22088020e-02  1.63081797e-01 -1.49445392e-01 -2.06620522e-02
 -3.61958905e-02 -1.02060848e-01 -4.00757645e-03 -1.94308815e-01
  1.40591892e-01  4.18870011e-02  2.60560555e-01]
[0] INFO:root:337 grad_with_respect_to_surface=[  4.64011458  17.08308308  -6.38119363  24.01851666  -3.28159314
  27.39797324 -30.53154986  22.84899529]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11593159 -0.04088398  0.15450699 -0.00705484  0.11951826  0.04837829
  0.13236421 -0.00860232]
[0] INFO:__main__:299 True coils dofs = [ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.0015184   0.00077036  0.00017012  0.00058127 -0.00178171  0.00022951
  0.000661  ]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.41438307e-03  3.04978439e-03  2.00019080e-03 -5.55928920e-03
  2.90209425e-04  6.54965807e-03 -5.26202240e-05 -5.20046973e-03]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000059.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.38690773140729
[0] INFO:root:288 J_stage_1=0.38690773140729
[0] INFO:root:289 J_stage_2=0.0971569753806652
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.4840647067879552 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:__main__:333 True vmec dofs = [ 0.11593159 -0.04088398  0.15450699 -0.00705484  0.11951826  0.04837829
  0.13236421 -0.00860232]
[0] INFO:__main__:334 True JF.x = [ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11593159 -0.04088398  0.15450699 -0.00705484  0.11951826  0.04837829
  0.13236421 -0.00860232]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11593159 -0.04088398  0.15450699 -0.00705484  0.11951826  0.04837829
  0.13236421 -0.00860232]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.38690773140729
[0] INFO:root:288 J_stage_1=0.38690773140729
[0] INFO:root:289 J_stage_2=0.0971569753806652
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:262 JF.x=[ 1.1366074   1.16100684  1.19005166  1.12077921 -0.0030541   0.3964095
 -0.00813669]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.000000e+00 4.088398e-06 0.000000e+00 0.000000e+00 0.000000e+00
 0.000000e+00 0.000000e+00 0.000000e+00]
[0] INFO:__main__:272 Running virtual casing
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.0015184   0.00077036  0.00017012  0.00058127 -0.00178171  0.00022951
  0.000661  ]
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.40278992e-03  3.04978439e-03  2.00019080e-03 -5.55928920e-03
  2.90209425e-04  6.54965807e-03 -6.58619074e-05 -5.19946973e-03]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000045.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000060.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3869065040933174
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3869822124639755
[0] INFO:root:288 J_stage_1=0.3869822124639755
[0] INFO:root:289 J_stage_2=0.09714877523211271
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.000000e+00 -4.088398e-06  0.000000e+00  1.000000e-06  0.000000e+00
  0.000000e+00  0.000000e+00  0.000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:root:288 J_stage_1=0.3869065040933174
[1] INFO:root:289 J_stage_2=0.09717363823102802
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.15931586e-05  0.00000000e+00  1.54506994e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000061.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000046.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.38692265209914634
[0] INFO:root:288 J_stage_1=0.38692265209914634
[0] INFO:root:289 J_stage_2=0.09715388194916479
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  4.83782944e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3868215927004044
[1] INFO:root:288 J_stage_1=0.3868215927004044
[1] INFO:root:289 J_stage_2=0.09715603954489956
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.54506994e-05  0.00000000e+00
  1.19518263e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000062.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000047.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3870395469055298
[0] INFO:root:288 J_stage_1=0.3870395469055298
[0] INFO:root:289 J_stage_2=0.0971505353690408
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -4.83782944e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.38690290011452516
[1] INFO:root:288 J_stage_1=0.38690290011452516
[1] INFO:root:289 J_stage_2=0.09716139374313774
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.19518263e-05  0.00000000e+00  1.32364214e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000063.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000048.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 51
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3869390500987342
[0] INFO:root:288 J_stage_1=0.3869390500987342
[0] INFO:root:289 J_stage_2=0.09715434600583447
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.38652568314301694
[1] INFO:root:288 J_stage_1=0.38652568314301694
[1] INFO:root:289 J_stage_2=0.09718055682911855
[0] INFO:root:336 grad_with_respect_to_coils=[-0.05236301 -0.01809684  0.00211429 -0.33648194  0.06561252  0.16628305
 -0.00514783 -0.01418208  0.02372963 -0.0696774  -0.02425065  0.03394099
  0.04474309 -0.04888819 -0.05202388  0.02944733  0.02918992 -0.0071627
  0.06005496 -0.07149362 -0.09547962 -0.14858763 -0.07045829  0.08580567
  0.0977751  -0.01929842 -0.03806187 -0.0122408   0.00562731  0.01213717
 -0.00394229 -0.00878651 -0.00240058  0.03816786  0.06908379  0.02572856
  0.01951123 -0.03184419 -0.0758524  -0.04834569  0.02114785  0.01253244
 -0.03071965 -0.01266345  0.00923235  0.02078748  0.00422776 -0.01811938
 -0.07623865  0.0889233   0.13828783 -0.06513883  0.10700622  0.27298236
 -0.01538595 -0.08119184  0.08924456  0.06206402 -0.18717902 -0.223811
  0.13227453  0.388654   -0.24696333  0.18094273  0.04444439 -0.08996524
 -0.1751612  -0.16345308  0.06989191  0.09475209  0.06485335 -0.21471595
 -0.03368119  0.24665043  0.08264478  0.06946738  0.11499262  0.03844883
  0.05581353 -0.06937005 -0.02038189  0.23406367  0.11438683 -0.23939433
 -0.2148664   0.27687851  0.2779267   0.07681777 -0.40949651 -0.06173954
  0.15639437 -0.13300276 -0.06744865  0.07344317  0.11785757  0.11291179
 -0.06192096 -0.1395362  -0.00489319  0.18742502  0.06392913 -0.05494945
  0.00628086 -0.01322969 -0.02923418  0.03386905  0.06367729  0.02503592
  0.06829721 -0.06036238  0.05888006 -0.03807047  0.01777101  0.0224694
  0.00971217  0.02178438  0.01089319 -0.02285992  0.00152216  0.00226934
 -0.00902993 -0.00711717  0.0026517   0.05357126  0.00815165 -0.05402271
  0.01705464  0.15988332  0.02946585 -0.16098975 -0.00369829  0.0830774
  0.04622899 -0.03011138 -0.02091839 -0.00602341  0.00931804 -0.02303798
  0.11557892  0.04480403  0.01331608  0.07415798 -0.14499833 -0.20548696
 -0.0495084   0.02083189  0.2386774   0.45387531 -0.01757023 -0.36909429
 -1.16935343 -1.33566378  0.79039743  0.07058565 -0.02424175 -0.07603864
 -0.13576244 -0.07931265 -0.10058082  0.0186927   0.02072745  0.30466224
  0.11214262  0.12981852 -0.37949815 -0.01519349  0.29115047 -0.89969379
  0.04593581  0.04522246 -0.05031907 -0.16458589  0.08062827  0.45606809
 -0.26426519  0.18976254 -0.14810887 -0.1798821  -0.02287625 -0.78433104
  0.62527888 -0.01457429  0.52062301]
[0] INFO:root:337 grad_with_respect_to_surface=[  1.33143494  16.21195102  -5.63563761  11.82726036  -0.03454956
  25.91564836 -27.08185282  28.68931661]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11965363 -0.04444159  0.15443691 -0.00627478  0.12453763  0.05181843
  0.13555916 -0.00819105]
[0] INFO:__main__:299 True coils dofs = [ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.00317044  0.00150989  0.00028919  0.00091084 -0.00349518  0.00091626
  0.00123759]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 3.72204676e-03 -3.55760552e-03 -7.00849865e-05  7.80066116e-04
  5.01936425e-03  3.44013670e-03  3.19495035e-03  4.10269393e-04]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000064.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3555841419231616
[0] INFO:root:288 J_stage_1=0.3555841419231616
[0] INFO:root:289 J_stage_2=0.11467325949118623
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.47025740141434785 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:__main__:333 True vmec dofs = [ 0.11965363 -0.04444159  0.15443691 -0.00627478  0.12453763  0.05181843
  0.13555916 -0.00819105]
[0] INFO:__main__:334 True JF.x = [ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11965363 -0.04444159  0.15443691 -0.00627478  0.12453763  0.05181843
  0.13555916 -0.00819105]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11965363 -0.04444159  0.15443691 -0.00627478  0.12453763  0.05181843
  0.13555916 -0.00819105]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3555841419231616
[0] INFO:root:288 J_stage_1=0.3555841419231616
[0] INFO:root:289 J_stage_2=0.11467325949118623
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:262 JF.x=[ 1.1381258   1.1617772   1.19022178  1.12136048 -0.00483581  0.39663901
 -0.00747568]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 4.44415855e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 0.00317044  0.00150989  0.00028919  0.00091084 -0.00349518  0.00091626
  0.00123759]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 3.73401212e-03 -3.55760552e-03 -7.00849865e-05  7.80066116e-04
  5.01936425e-03  3.44013670e-03  3.18171392e-03  4.11269393e-04]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000065.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000049.nc
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.35569096724404103
[0] INFO:root:288 J_stage_1=0.35569096724404103
[0] INFO:root:289 J_stage_2=0.11466738926811312
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -4.44415855e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.35558148024897185
[1] INFO:root:288 J_stage_1=0.35558148024897185
[1] INFO:root:289 J_stage_2=0.11471012475179357
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.19653632e-05  0.00000000e+00  1.54436909e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000066.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000050.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.35560478566987425
[0] INFO:root:288 J_stage_1=0.35560478566987425
[0] INFO:root:289 J_stage_2=0.11467039947418992
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  5.18184311e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.35554155470126025
[1] INFO:root:288 J_stage_1=0.35554155470126025
[1] INFO:root:289 J_stage_2=0.11467072986234673
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00 -1.54436909e-05  0.00000000e+00
  1.24537628e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000067.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000051.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3557669474875424
[0] INFO:root:288 J_stage_1=0.3557669474875424
[0] INFO:root:289 J_stage_2=0.11466525474569614
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -5.18184311e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000068.nc
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.35559569951188463
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:root:288 J_stage_1=0.35559569951188463
[1] INFO:root:289 J_stage_2=0.11466841649186887
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.24537628e-05  0.00000000e+00  1.35559164e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000052.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.35562252749404843
[0] INFO:root:288 J_stage_1=0.35562252749404843
[0] INFO:root:289 J_stage_2=0.11467100549756089
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.35518381532865767
[1] INFO:root:288 J_stage_1=0.35518381532865767
[1] INFO:root:289 J_stage_2=0.1147025748988399
[0] INFO:root:336 grad_with_respect_to_coils=[ 1.41061896e-02  2.92167430e-02  2.49497819e-02 -6.71720213e-01
 -1.64135440e-02  3.04811768e-01  4.30616570e-02 -1.66782823e-01
  1.39628094e-02 -1.48062824e-01  1.38763856e-02  1.64267814e-01
  1.64700522e-01 -1.73574018e-02 -1.67043381e-01 -1.43136351e-01
  1.33671124e-01  3.75837490e-01  6.04804372e-02 -1.51224860e-02
 -3.09576461e-01 -1.29164743e-01 -6.11891969e-02  7.02013474e-02
  9.72553456e-02  4.21956424e-02 -1.38148848e-01 -5.80961347e-02
  1.67369053e-01  3.31747844e-02 -6.38616507e-01 -3.60057634e-01
  1.76545996e+00 -1.85408048e-02 -1.97339489e-01  1.58359402e-02
  2.29096584e-01 -9.47540936e-03 -3.58608122e-01 -2.98877950e-01
  4.63066711e-01  6.14067927e-01 -5.08740887e-01 -9.56581066e-01
  3.41980208e-01  1.60280209e+00 -2.10929416e-02 -1.91535306e+00
 -2.58530175e-01 -8.84357043e-02  4.81229770e-01  5.93618959e-02
  2.38300716e-02  1.58145437e-01 -4.35714606e-02 -1.08786911e-01
  1.20533151e-01  1.29700820e-01 -3.03149894e-02 -5.46101303e-02
 -3.39066816e-02 -3.35150337e-03  3.76925184e-02  3.76648266e-01
  4.00906374e-01 -3.48559825e-01 -4.13315207e-01 -2.99108037e-01
  2.66010703e-02  2.56182233e-01  1.03812317e-01 -1.55349539e-01
 -8.79835346e-02  3.48328570e-02  4.42065470e-02  7.54729823e-02
  1.62927161e-02 -8.06870750e-02 -2.72734303e-01 -1.11593200e-01
  1.24963137e-01  3.90556868e-01  5.94331977e-02 -1.74206003e-01
 -2.44677746e-01  1.25908870e-01  1.38052016e-01  2.14837422e-02
 -1.50732187e-01 -1.85587034e-02  2.81933674e-02 -9.85652418e-04
  1.03322574e-02  1.90523575e-03 -6.54232134e-02  2.71873007e-01
 -4.37670039e-02  9.57824189e-02 -7.43622889e-03  3.01349248e-01
 -1.36176202e-01  3.05130940e-01  4.08046263e-01 -1.61205385e-02
 -3.28505301e-01  5.20114370e-03  6.16146120e-01  6.51521319e-01
  1.77510206e-01  1.81227419e-01 -1.00555133e-01 -8.66373610e-02
 -3.18834759e-01 -6.62532709e-02  1.40752831e-01  3.16339438e-01
  2.14140086e-01 -1.17157723e-01 -2.84616195e-01 -4.69325688e-01
 -8.77675699e-02 -4.33906979e-01  2.75240824e-01 -3.17711160e-01
 -2.27467636e-01 -2.01438358e-02  3.40738001e-01  3.60770191e-01
  9.29025002e-02 -7.27773499e-01 -3.29283439e-01  3.21707523e-01
  1.99256673e-01  3.63719521e-01  1.76679757e-01  3.29176896e-01
  4.97442312e-01 -3.25051792e-01 -4.86087958e-03 -7.61019499e-02
  4.15208630e-01  2.94568748e-02  8.35138623e-02 -5.45825172e-03
  1.26973750e-01 -1.33353718e-01  4.70492979e-02  4.08135791e-02
  1.21314427e-01  5.69799690e-02 -2.86980277e-02  3.27151355e-02
 -5.92835237e-02 -4.96215584e-04  5.26777799e-02  2.20542950e-01
  1.22644539e-02 -2.19028712e-02  3.52930204e-02  1.67910240e-01
  5.65910211e-02 -5.41485589e-02  3.68846715e-02  7.84221168e-02
  6.39383264e-03  4.26980757e-02 -6.65546316e-02  2.96156454e-02
 -1.26639509e-01  2.35972310e-01 -7.18052690e-02  5.36421635e-02
  1.78804979e-01  4.91424291e-01 -1.66167141e-01 -1.15724182e-01
  9.80933414e-02  1.31712523e-01 -8.91881405e-03 -5.40648702e-02
  4.64036658e-02 -2.33061669e-02 -2.90005402e-02]
[0] INFO:root:337 grad_with_respect_to_surface=[  2.85854978  22.71635825  -2.92137748  17.78372972   0.5391615
  33.73332908 -27.36894912  36.13157726]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11951245 -0.04721709  0.15494051 -0.00493633  0.12548561  0.05255507
  0.13662079 -0.00729709]
[0] INFO:__main__:299 True coils dofs = [ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.48345716e-03  6.27934557e-04  6.60256653e-05  1.58441563e-03
 -1.60950217e-03 -5.25342206e-05  3.34626631e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00014119 -0.00277551  0.0005036   0.00133844  0.00094798  0.00073664
  0.00106163  0.00089296]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000069.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3466457283525
[0] INFO:root:288 J_stage_1=0.3466457283525
[0] INFO:root:289 J_stage_2=0.11308947070174763
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.45973519905424765 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:__main__:333 True vmec dofs = [ 0.11951245 -0.04721709  0.15494051 -0.00493633  0.12548561  0.05255507
  0.13662079 -0.00729709]
[0] INFO:__main__:334 True JF.x = [ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11951245 -0.04721709  0.15494051 -0.00493633  0.12548561  0.05255507
  0.13662079 -0.00729709]
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11951245 -0.04721709  0.15494051 -0.00493633  0.12548561  0.05255507
  0.13662079 -0.00729709]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3466457283525
[0] INFO:root:288 J_stage_1=0.3466457283525
[0] INFO:root:289 J_stage_2=0.11308947070174763
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:262 JF.x=[ 1.14129624  1.16328709  1.19051097  1.12227133 -0.00833099  0.39755528
 -0.00623809]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 4.72170912e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.48345716e-03  6.27934557e-04  6.60256653e-05  1.58441563e-03
 -1.60950217e-03 -5.25342206e-05  3.34626631e-04]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00012924 -0.00277551  0.0005036   0.00133844  0.00094798  0.00073664
  0.00104807  0.00089396]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000070.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000053.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.34676473065633795
[0] INFO:root:288 J_stage_1=0.34676473065633795
[0] INFO:root:289 J_stage_2=0.11308355381259425
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -4.72170912e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3466515371325229
[1] INFO:root:288 J_stage_1=0.3466515371325229
[1] INFO:root:289 J_stage_2=0.11312949905147884
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.19512445e-05  0.00000000e+00  1.54940510e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000071.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000054.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3466708287471944
[0] INFO:root:288 J_stage_1=0.3466708287471944
[0] INFO:root:289 J_stage_2=0.11308677342254073
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e-06
  0.00000000e+00  5.25550696e-06  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3466174994570294
[1] INFO:root:288 J_stage_1=0.3466174994570294
[1] INFO:root:289 J_stage_2=0.11308614908133204
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.0000000e+00  0.0000000e+00 -1.5494051e-05  0.0000000e+00
  1.2548561e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000072.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000055.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3468410863065031
[0] INFO:root:288 J_stage_1=0.3468410863065031
[0] INFO:root:289 J_stage_2=0.11308086068908685
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -5.25550696e-06  0.00000000e+00  1.00000000e-06]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.34665089183108266
[1] INFO:root:288 J_stage_1=0.34665089183108266
[1] INFO:root:289 J_stage_2=0.11307978654113293
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.25485610e-05  0.00000000e+00  1.36620793e-05  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000073.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000056.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.34668379095950774
[0] INFO:root:288 J_stage_1=0.34668379095950774
[0] INFO:root:289 J_stage_2=0.11308732025098674
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3462365639091355
[1] INFO:root:288 J_stage_1=0.3462365639091355
[1] INFO:root:289 J_stage_2=0.11311912874840763
[0] INFO:root:336 grad_with_respect_to_coils=[ 0.02573874  0.03847565  0.03070033 -0.72571951 -0.04520141  0.44690063
  0.04940515 -0.21618949 -0.01945828 -0.08219829 -0.03962986  0.14836697
  0.08825786 -0.10726623 -0.08594101  0.05902498  0.03328237 -0.00964392
  0.06956947  0.1313473  -0.31280496 -0.23353372 -0.07717267  0.16568832
  0.16742564 -0.00577168 -0.07746245 -0.05603076  0.00565799  0.05072725
  0.0158983  -0.02096583 -0.03356663 -0.04949663  0.01990695  0.05431764
 -0.02935729 -0.11990412 -0.06938196 -0.01257547  0.0990261   0.00461876
 -0.06613118 -0.01612192  0.01798721  0.05177407  0.00833815 -0.04430545
 -0.31129075 -0.15411562  0.52394159  0.10962061 -0.00196723  0.11553537
 -0.05753898 -0.10860969  0.14518216  0.13202172 -0.03378295 -0.05275374
 -0.0314713  -0.00793138  0.03499815  0.4276694   0.47456727 -0.43224954
 -0.45325673 -0.29802314  0.02244326  0.28124424  0.10662259 -0.15700558
 -0.08886516  0.0242408   0.03916096  0.06659369  0.00869322 -0.0627353
 -0.36857991 -0.1640933   0.15543599  0.41342432  0.03852188 -0.16840981
 -0.20924391  0.13740459  0.1160719   0.00682616 -0.12610393 -0.00641991
  0.013598   -0.0035658   0.01786625 -0.03271661 -0.06386878  0.44405319
 -0.03073808  0.0725893   0.06340002  0.24433546 -0.00439238  0.05774822
  0.06437092  0.0364584  -0.04651264  0.02509939  0.03208637  0.04144561
  0.2141292   0.22822025  0.0055431  -0.10712459 -0.31421816 -0.03030888
  0.09953731  0.04583925  0.03077285  0.00189625 -0.05093404 -0.07405871
 -0.01759032  0.01120375  0.06981731 -0.41961227 -0.15869865  0.02729392
  0.3449777   0.36118368  0.17603518 -0.47847479 -0.0429969   0.17627038
  0.10524208 -0.01465119  0.03424905  0.04343883  0.04712899 -0.0405112
 -0.02940708 -0.11959596  0.39423933 -0.03980292  0.09479453 -0.02439005
  0.14378197 -0.1267291   0.00747114  0.03263547  0.07223891  0.25426165
 -0.01372016  0.54553378 -0.29310215 -0.00187605  0.10361146  0.18146072
  0.0601889  -0.0838054   0.04521547  0.14985612  0.05500466 -0.11172798
 -0.01887509  0.13667372 -0.08960316  0.393935   -0.31182468  0.41615547
 -0.17875845  0.12202893 -0.07113162  0.07217209  0.21369397  0.64911008
 -0.24012422  0.0418558   0.02596052  0.1854133   0.13325553 -0.1673519
  0.34411149 -0.04516515 -0.53800191]
[0] INFO:root:337 grad_with_respect_to_surface=[  3.83534365  23.95010195  -2.03629869  22.40311549  -0.36025502
  35.53376352 -27.77808479  35.91215625]
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:__main__:294 Entering fun
[0] INFO:__main__:298 True vmec dofs = [ 0.11861582 -0.04909289  0.15571079 -0.00414546  0.1256517   0.05302926
  0.13699676 -0.00688892]
[0] INFO:__main__:299 True coils dofs = [ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:root:261 dofs_coils=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.39738364e-03  5.14225050e-04 -9.61501759e-06  2.48789528e-03
 -1.37102193e-03 -5.34750429e-04  2.09596429e-04]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00089663 -0.0018758   0.00077027  0.00079088  0.00016609  0.00047419
  0.00037597  0.00040716]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000074.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.339965223862251
[0] INFO:root:288 J_stage_1=0.339965223862251
[0] INFO:root:289 J_stage_2=0.10375973084620138
[0] INFO:__main__:306 Writing result
[0] INFO:__main__:328 Objective function 0.44372495470845236 is smaller than the threshold 250
[0] INFO:__main__:329 Now calculating the gradient
[0] INFO:__main__:332 True coils dofs = [ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:__main__:333 True vmec dofs = [ 0.11861582 -0.04909289  0.15571079 -0.00414546  0.1256517   0.05302926
  0.13699676 -0.00688892]
[0] INFO:__main__:334 True JF.x = [ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[1] INFO:simsopt._core.finite_difference:202 Beginning parallel finite difference gradient calculation
[0] INFO:simsopt._core.finite_difference:211 nparams: 8
[1] INFO:simsopt._core.finite_difference:211 nparams: 8
[0] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11861582 -0.04909289  0.15571079 -0.00414546  0.1256517   0.05302926
  0.13699676 -0.00688892]
[1] INFO:simsopt._core.finite_difference:212 x0:  [ 0.11861582 -0.04909289  0.15571079 -0.00414546  0.1256517   0.05302926
  0.13699676 -0.00688892]
[0] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:root:262 JF.x=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.339965223862251
[0] INFO:root:288 J_stage_1=0.339965223862251
[0] INFO:root:289 J_stage_2=0.10375973084620138
[1] INFO:simsopt._core.finite_difference:245 size of evals is (1, 9)
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[1] INFO:root:261 dofs_coils=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:root:262 JF.x=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[1] INFO:root:262 JF.x=[ 1.1427797   1.16391503  1.190577    1.12385574 -0.00994049  0.39750274
 -0.00590346]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[0.00000000e+00 4.90928905e-06 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:root:264 Altering JF.x with dofs_coils-JF.x=[ 1.39738364e-03  5.14225050e-04 -9.61501759e-06  2.48789528e-03
 -1.37102193e-03 -5.34750429e-04  2.09596429e-04]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-0.00088476 -0.0018758   0.00077027  0.00079088  0.00016609  0.00047419
  0.00036231  0.00040816]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000075.nc
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000057.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.objectives.least_squares:207 objective() called with x=None
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[0] INFO:simsopt.objectives.least_squares:214 objective(): 0.3400877942214386
[0] INFO:root:288 J_stage_1=0.3400877942214386
[0] INFO:root:289 J_stage_2=0.103753389616532
[0] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[0] INFO:root:261 dofs_coils=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:root:262 JF.x=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[0] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[ 0.00000000e+00 -4.90928905e-06  0.00000000e+00  1.00000000e-06
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[0] INFO:__main__:272 Running virtual casing
[0] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[0] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[0] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[1] INFO:simsopt.objectives.least_squares:214 objective(): 0.3399750531578991
[1] INFO:root:288 J_stage_1=0.3399750531578991
[1] INFO:root:289 J_stage_2=0.10379877207952895
[1] INFO:simsopt._core.optimizable:1531 reassembled args len is 2
[1] INFO:root:261 dofs_coils=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[1] INFO:root:262 JF.x=[ 1.14417708  1.16442925  1.19056738  1.12634364 -0.01131151  0.39696799
 -0.00569386]
[1] INFO:root:267 Altering prob.x with dofs_vmec-prob.x=[-1.18615819e-05  0.00000000e+00  1.55710785e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
[1] INFO:__main__:272 Running virtual casing
[1] INFO:simsopt.mhd.vmec:662 Preparing to run VMEC.
[1] INFO:simsopt.mhd.vmec:684 Calling VMEC reinit().
[1] INFO:simsopt.mhd.vmec:687 Calling runvmec().
[0] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[0] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[0] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/vmec/wout_QH_finitebeta_000_000076.nc
[0] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[0] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[0] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
[1] INFO:simsopt.mhd.vmec:699 Calling VMEC cleanup().
[1] INFO:simsopt.mhd.vmec:716 VMEC run complete. Now loading output.
[1] INFO:simsopt.mhd.vmec:766 Attempting to read file /Users/rogeriojorge/local/some_optimizations/single_stage_finite_beta/optimization_QH_len3.1_finitebeta/wout_QH_finitebeta_001_000058.nc
[1] INFO:simsopt.mhd.vmec:720 Done loading VMEC output.
[1] INFO:simsopt.mhd.virtual_casing:173 new src_ntheta: 50
[1] INFO:simsopt.mhd.vmec:656 run() called but no need to re-run VMEC.
