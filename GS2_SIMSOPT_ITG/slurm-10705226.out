Initial aspect ratio: 8.032497901971727
Initial mean iota: -0.9073732888245726
Initial magnetic well: -0.11352199535921875
Initial growth rate: 0.11601592753249647
## Now calculating total objective function ##
Total objective before optimization: 0.14151845424567047
-------------------------
Optimizing with max_mode = 1
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         7.0759e-02                                    6.24e-02    
       1              2         7.0676e-02      8.36e-05       1.12e-02       1.89e+00    
       2              4         7.0513e-02      1.63e-04       4.97e-03       6.93e-01    
       3              6         7.0485e-02      2.74e-05       1.21e-03       1.98e-01    
       4              9         7.0483e-02      2.69e-06       7.59e-05       8.73e-03    
       5             14         7.0483e-02      2.89e-10       5.93e-07       5.05e-03    
       6             18         7.0483e-02      0.00e+00       0.00e+00       5.05e-03    
`xtol` termination condition is satisfied.
Function evaluations 18, initial cost 7.0759e-02, final cost 7.0483e-02, first-order optimality 5.05e-03.
Final aspect ratio: 8.030276689847934
Final mean iota: -0.9242539671561683
Final magnetic well: -0.11529654545381059
Final quasisymmetry: 0.1400486350482545
Final growth rate: 0.11953443909333746
## Now calculating total objective function ##
Total objective before optimization: 0.1409653129964022
-------------------------
Optimizing with max_mode = 2
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         7.0483e-02                                    5.42e+00    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       1              3         5.0725e-02      1.98e-02       2.77e-02       9.67e+13    
       2              4         1.0932e-02      3.98e-02       2.77e-02       1.27e+01    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       3              5         5.1847e-03      5.75e-03       6.93e-03       5.24e+11    
       4              6         3.9180e-03      1.27e-03       1.39e-02       3.70e+00    
       5              8         2.7204e-03      1.20e-03       3.02e-03       7.71e-01    
       6              9         2.4725e-03      2.48e-04       6.03e-03       2.40e+00    
       7             11         2.2570e-03      2.16e-04       3.02e-03       6.14e-01    
       8             12         2.1444e-03      1.13e-04       6.03e-03       2.77e+00    
       9             13         1.9395e-03      2.05e-04       6.03e-03       2.71e+00    
      10             14         1.7871e-03      1.52e-04       6.03e-03       2.93e+00    
      11             15         1.5767e-03      2.10e-04       6.03e-03       2.60e+00    
      12             16         1.4665e-03      1.10e-04       6.03e-03       2.54e+00    
      13             17         1.4162e-03      5.03e-05       6.03e-03       3.58e+00    
      14             18         1.1677e-03      2.49e-04       1.51e-03       3.38e-01    
      15             19         1.1390e-03      2.86e-05       3.02e-03       6.56e-01    
      16             21         1.1032e-03      3.58e-05       1.51e-03       3.57e-01    
      17             22         1.0968e-03      6.39e-06       3.02e-03       7.47e-01    
      18             23         1.0615e-03      3.53e-05       7.54e-04       1.74e-01    
      19             24         1.0429e-03      1.86e-05       1.51e-03       3.15e-01    
      20             25         1.0329e-03      1.01e-05       3.02e-03       6.86e-01    
      21             26         1.0091e-03      2.38e-05       3.02e-03       6.54e-01    
      22             27         9.8450e-04      2.46e-05       3.02e-03       6.51e-01    
      23             28         9.6023e-04      2.43e-05       3.02e-03       4.63e-01    
      24             29         9.4434e-04      1.59e-05       3.02e-03       5.25e-01    
      25             31         9.2933e-04      1.50e-05       7.54e-04       2.12e-01    
      26             32         9.2090e-04      8.43e-06       1.51e-03       3.96e-01    
      27             33         9.1519e-04      5.71e-06       3.02e-03       3.44e-01    
      28             34         9.0957e-04      5.62e-06       3.02e-03       2.04e-01    
      29             36         8.9985e-04      9.72e-06       7.54e-04       6.55e-02    
      30             37         8.9889e-04      9.59e-07       1.51e-03       1.00e-01    
      31             38         8.9399e-04      4.90e-06       3.77e-04       7.56e-02    
      32             41         8.9382e-04      1.65e-07       2.36e-05       5.84e-02    
      33             47         8.9381e-04      4.85e-09       5.75e-09       5.84e-02    
      34             50         8.9381e-04      0.00e+00       0.00e+00       5.84e-02    
`xtol` termination condition is satisfied.
Function evaluations 50, initial cost 7.0483e-02, final cost 8.9381e-04, first-order optimality 5.84e-02.
Final aspect ratio: 8.000513365053093
Final mean iota: -1.1659213221976166
Final magnetic well: -0.006913201386932988
Final quasisymmetry: 0.001787366407946378
Final growth rate: 0.19976337891857235
## Now calculating total objective function ##
Total objective before optimization: 0.0017876299516241232
-------------------------
Optimizing with max_mode = 3
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         8.9381e-04                                    3.64e+00    
       1              3         5.3485e-04      3.59e-04       8.70e-03       6.12e+00    
       2              4         2.7535e-04      2.59e-04       8.70e-03       3.08e+00    
       3              5         1.7400e-04      1.01e-04       8.70e-03       1.92e+00    
       4              6         1.5933e-04      1.47e-05       8.70e-03       1.30e+00    
       5              7         6.6343e-05      9.30e-05       2.18e-03       4.01e-01    
       6              9         5.9771e-05      6.57e-06       1.09e-03       1.07e-01    
       7             11         5.8136e-05      1.63e-06       5.44e-04       7.29e-02    
       8             12         5.6824e-05      1.31e-06       5.44e-04       9.80e-02    
       9             13         5.4752e-05      2.07e-06       5.44e-04       3.07e-02    
      10             14         5.3632e-05      1.12e-06       1.09e-03       1.42e-01    
      11             15         5.1876e-05      1.76e-06       1.09e-03       9.89e-02    
      12             16         5.1502e-05      3.74e-07       1.09e-03       6.79e-02    
      13             17         5.0340e-05      1.16e-06       2.72e-04       4.56e-02    
      14             18         5.0128e-05      2.12e-07       2.72e-04       4.58e-02    
      15             19         4.9891e-05      2.38e-07       2.72e-04       4.10e-02    
      16             20         4.9704e-05      1.87e-07       2.72e-04       4.31e-02    
      17             21         4.9413e-05      2.91e-07       2.72e-04       4.29e-02    
      18             22         4.9151e-05      2.61e-07       2.72e-04       5.23e-02    
      19             24         4.9031e-05      1.21e-07       6.80e-05       1.94e-02    
      20             29         4.9030e-05      1.13e-09       2.66e-07       1.74e-02    
      21             30         4.9030e-05      3.59e-11       6.64e-08       1.72e-02    
      22             31         4.9030e-05      3.22e-12       1.66e-08       1.72e-02    
      23             32         4.9030e-05      8.52e-13       4.15e-09       1.72e-02    
      24             33         4.9030e-05      0.00e+00       0.00e+00       1.72e-02    
`xtol` termination condition is satisfied.
Function evaluations 33, initial cost 8.9381e-04, final cost 4.9030e-05, first-order optimality 1.72e-02.
Final aspect ratio: 8.000047184600403
Final mean iota: -1.2152717041280923
Final magnetic well: -0.008142397173182332
Final quasisymmetry: 9.80571469210527e-05
Final growth rate: 0.17853347509221706
## Now calculating total objective function ##
Total objective before optimization: 9.805937330756775e-05
-------------------------
Optimizing with max_mode = 4
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         4.9030e-05                                    4.69e-01    
       1              4         4.3079e-05      5.95e-06       1.24e-03       3.90e-01    
       2              6         4.1028e-05      2.05e-06       3.11e-04       1.87e-01    
       3              7         4.0822e-05      2.06e-07       7.77e-05       2.41e-01    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       4              8         3.9738e-05      1.08e-06       1.94e-05       5.93e+09    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       5              9         3.9648e-05      9.04e-08       1.94e-05       1.27e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       6             10         3.9539e-05      1.09e-07       4.86e-06       1.34e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       7             11         3.9510e-05      2.85e-08       4.86e-06       1.43e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       8             12         3.9501e-05      9.33e-09       1.21e-06       1.44e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       9             13         3.9499e-05      1.98e-09       3.04e-07       1.45e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
      10             14         3.9498e-05      4.57e-10       7.59e-08       1.45e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
      11             15         3.9498e-05      1.12e-10       1.90e-08       1.45e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
      12             16         3.9498e-05      2.79e-11       4.74e-09       1.45e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
      13             17         3.9498e-05      7.11e-12       1.19e-09       1.45e+10    
`xtol` termination condition is satisfied.
Function evaluations 17, initial cost 4.9030e-05, final cost 3.9498e-05, first-order optimality 1.45e+10.
Final aspect ratio: 7.999929452513499
Final mean iota: -1.2175580576407672
Final magnetic well: -0.00804908280066682
Final quasisymmetry: 7.899148536721031e-05
Final growth rate: 0.17985183579705052
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  SEQ =    1 TIME SLICE  0.0000E+00
  PROCESSING INPUT.final
  THIS IS PARVMEC (PARALLEL VMEC), VERSION 9.0
  Lambda: Full Radial Mesh. L-Force: hybrid full/half.

  COMPUTER:    OS:    RELEASE:   DATE = Dec 21,2022  TIME = 01:51:15

  NS =   16 NO. FOURIER MODES =   72 FTOLV =  1.000E-12 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1
 INITIAL JACOBIAN CHANGED SIGN!
 TRYING TO IMPROVE INITIAL MAGNETIC AXIS GUESS
  ---- Improved AXIS Guess ----
      RAXIS_CC =   0.99372982016208899       0.21049003331375996        1.9486492213434528E-002  -4.6901138995742789E-003   3.1288952554517558E-004   1.9799992448298483E-003  -7.4306611443963736E-004
      ZAXIS_CS =   -0.0000000000000000       0.16848338855225065        1.0189372846488744E-002  -5.1708294598928530E-003  -2.2464770714096033E-003  -3.9176631932769474E-003  -3.5844422143743063E-003
  -----------------------------

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  9.64E-02  7.87E-02  6.40E-02  1.221E+00  9.00E-01  1.9339E-01
  200  1.73E-08  9.09E-09  9.08E-09  1.208E+00  7.29E-01  1.8535E-01
  400  3.20E-10  1.79E-10  1.29E-10  1.209E+00  7.29E-01  1.8535E-01
  600  4.28E-11  2.72E-11  3.28E-11  1.209E+00  7.29E-01  1.8535E-01
  800  9.95E-12  5.23E-12  5.36E-12  1.209E+00  7.29E-01  1.8535E-01
 1000  1.49E-12  8.21E-13  8.79E-13  1.209E+00  7.29E-01  1.8535E-01
 1053  9.80E-13  5.85E-13  5.52E-13  1.209E+00  7.29E-01  1.8535E-01

  NS =   51 NO. FOURIER MODES =   72 FTOLV =  1.000E-13 NITER =  10000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  1.52E-02  6.06E-03  1.33E-05  1.209E+00  9.00E-01  1.8535E-01
  200  5.89E-09  4.42E-09  1.05E-10  1.209E+00  6.37E-01  1.8535E-01
  400  1.43E-10  5.95E-11  7.29E-12  1.209E+00  6.37E-01  1.8535E-01
  600  7.12E-12  3.19E-12  8.96E-13  1.209E+00  6.37E-01  1.8535E-01
  800  1.52E-12  5.12E-13  1.01E-13  1.209E+00  6.37E-01  1.8535E-01
 1000  3.29E-13  1.66E-13  5.41E-14  1.209E+00  6.37E-01  1.8535E-01
 1139  9.99E-14  4.97E-14  1.55E-14  1.209E+00  6.37E-01  1.8535E-01

  NS =  101 NO. FOURIER MODES =   72 FTOLV =  1.000E-14 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  1.27E-02  4.37E-03  2.02E-07  1.209E+00  9.00E-01  1.8535E-01
  200  8.40E-09  9.22E-09  6.69E-12  1.209E+00  5.16E-01  1.8535E-01
  400  1.83E-10  1.41E-10  4.56E-13  1.209E+00  5.16E-01  1.8535E-01
  600  2.24E-11  3.69E-11  6.76E-14  1.209E+00  5.16E-01  1.8535E-01
  800  1.14E-12  9.53E-13  1.67E-14  1.209E+00  5.16E-01  1.8535E-01
 1000  5.23E-13  3.39E-13  5.31E-15  1.209E+00  5.16E-01  1.8535E-01
 1200  2.43E-13  1.62E-13  2.14E-15  1.209E+00  5.16E-01  1.8535E-01
 1400  6.36E-14  4.66E-14  1.13E-15  1.209E+00  5.16E-01  1.8535E-01
 1600  1.17E-14  8.60E-15  4.25E-16  1.209E+00  5.16E-01  1.8535E-01
 1649  9.96E-15  6.11E-15  3.36E-16  1.209E+00  5.16E-01  1.8535E-01

 EXECUTION TERMINATED NORMALLY

 FILE : final_000_000000
 NUMBER OF JACOBIAN RESETS =    5

    TOTAL COMPUTATIONAL TIME (SEC)        22.52
    TIME TO INPUT/OUTPUT                   0.03
       READ IN DATA                        0.00
       WRITE OUT DATA TO WOUT              0.03
    TIME IN FUNCT3D                       22.34
       BCOVAR FIELDS                       3.19
       FOURIER TRANSFORM                   4.85
       INVERSE FOURIER TRANSFORM           4.55
       FORCES AND SYMMETRIZE               3.63
       RESIDUE                             3.99
       EQFORCE                             0.00
nfp:  4
ns:  101
mpol:  6
ntor:  6
Aminor_p:  0.12389574896401945
Rmajor_p:  0.9911572511784776
aspect:             7.999929452513496
Rmajor_p/Aminor_p:  7.999929452513496
betatotal:  0.0
betapol:    0.0
betator:    0.0
betaxis:    0.0
ctor:    -3.06287113727155e-11
bmnc.shape: (101, 162)
bmns.shape: (101, 162)
No module named 'mayavi'
Creating Boozer class for vmec_final
Defining surfaces where to compute Boozer coordinates
 booz_surfaces=[0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9]
Running BOOZ_XFORM
mnmax: 72  len(xm): 72  len(xn): 72
mnmax_nyq: 162  len(xm_nyq): 162  len(xn_nyq): 162
Read ns=101, mpol=6, ntor=6, mnmax=72, mnmax_nyq=162
compute_surfs (0-based indices):  0 10 20 30 39 49 60 70 79 89
Initializing with mboz=64, nboz=64
ntheta = 258, nzeta = 258, # threads = 24
                   |        outboard (theta=0)      |      inboard (theta=pi)      |
thread js_b js zeta| |B|input  |B|Boozer    Error   | |B|input  |B|Boozer    Error |
------------------------------------------------------------------------------------
   4     4  39   0  1.012e+00  1.012e+00  2.083e-14  1.233e+00  1.233e+00  3.224e-14
                pi  1.232e+00  1.232e+00  2.109e-14  1.013e+00  1.013e+00  1.096e-15
   6     6  60   0  9.905e-01  9.905e-01  3.363e-16  1.265e+00  1.265e+00  7.724e-15
                pi  1.263e+00  1.263e+00  1.371e-14  9.910e-01  9.910e-01  2.129e-15
   0     0   0   0  1.101e+00  1.101e+00  1.573e-14  1.125e+00  1.125e+00  3.472e-14
                pi  1.125e+00  1.125e+00  1.579e-15  1.101e+00  1.101e+00  2.945e-14
   9     9  89   0  9.664e-01  9.664e-01  8.272e-15  1.303e+00  1.303e+00  2.045e-14
                pi  1.298e+00  1.298e+00  3.422e-15  9.663e-01  9.663e-01  1.402e-14
   7     7  70   0  9.816e-01  9.816e-01  1.425e-14  1.279e+00  1.279e+00  9.378e-15
                pi  1.276e+00  1.276e+00  1.914e-14  9.819e-01  9.819e-01  6.332e-15
   2     2  20   0  1.039e+00  1.039e+00  6.411e-16  1.197e+00  1.197e+00  5.009e-15
                pi  1.196e+00  1.196e+00  5.013e-15  1.040e+00  1.040e+00  4.912e-15
   5     5  49   0  1.001e+00  1.001e+00  6.874e-15  1.249e+00  1.249e+00  1.103e-14
                pi  1.247e+00  1.247e+00  3.204e-15  1.002e+00  1.002e+00  3.324e-15
   3     3  30   0  1.024e+00  1.024e+00  6.072e-15  1.217e+00  1.217e+00  1.642e-14
                pi  1.216e+00  1.216e+00  3.652e-16  1.025e+00  1.025e+00  2.081e-14
   8     8  79   0  9.741e-01  9.741e-01  3.419e-16  1.290e+00  1.290e+00  3.442e-15
                pi  1.287e+00  1.287e+00  8.282e-15  9.743e-01  9.743e-01  2.849e-15
   1     1  10   0  1.059e+00  1.059e+00  3.145e-15  1.172e+00  1.172e+00  2.634e-14
                pi  1.171e+00  1.171e+00  1.763e-14  1.060e+00  1.060e+00  3.122e-14
Writing output to /marconi_scratch/userexternal/rjorge00/some_optimizations/GS2_SIMSOPT_ITG/output_MAXITER350_least_squares_nfp4_QH_QH_onlyQS/boozmn_single_stage.nc
Plot BOOZ_XFORM
Whole optimization took 3617.051818s
