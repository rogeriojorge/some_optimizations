Initial aspect ratio: 6.002990249024757
Initial mean iota: 0.39939858456440464
Initial magnetic well: -0.04553931505796013
-------------------------
Optimizing with max_mode = 1
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         4.9831e-03                                    1.14e-01    
       1              5         4.9792e-03      3.96e-06       2.77e-04       1.32e-02    
       2              9         4.9792e-03      3.90e-08       4.33e-06       8.51e-03    
`ftol` termination condition is satisfied.
Function evaluations 9, initial cost 4.9831e-03, final cost 4.9792e-03, first-order optimality 8.51e-03.
Final aspect ratio: 6.00088465078496
Final mean iota: 0.399196195152133
Final magnetic well: -0.045585748948183874
Final quasisymmetry: 0.009523154109598867
-------------------------
Optimizing with max_mode = 2
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         4.9792e-03                                    8.36e-01    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       1              3         2.7019e-03      2.28e-03       1.86e-02       1.35e+00    
       2              4         1.2852e-03      1.42e-03       1.86e-02       1.50e+00    
       3              5         5.8731e-04      6.98e-04       1.86e-02       1.33e+00    
       4              6         1.8438e-04      4.03e-04       1.86e-02       2.21e-01    
       5              8         1.6194e-04      2.24e-05       9.29e-03       2.36e-01    
       6             10         1.3415e-04      2.78e-05       2.32e-03       5.41e-02    
       7             11         1.3386e-04      2.91e-07       4.65e-03       1.43e-01    
       8             12         1.2356e-04      1.03e-05       1.16e-03       4.08e-02    
       9             13         1.2122e-04      2.34e-06       2.32e-03       6.10e-02    
      10             14         1.1985e-04      1.37e-06       2.32e-03       9.81e-02    
      11             15         1.1524e-04      4.61e-06       2.32e-03       5.60e-02    
      12             16         1.1341e-04      1.83e-06       2.32e-03       6.13e-02    
      13             17         1.1240e-04      1.01e-06       2.32e-03       5.53e-02    
      14             18         1.1061e-04      1.79e-06       5.81e-04       1.77e-02    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
      15             19         1.1007e-04      5.40e-07       5.81e-04       4.10e+11    
      16             20         1.0901e-04      1.06e-06       5.81e-04       1.45e-02    
      17             21         1.0863e-04      3.84e-07       1.16e-03       2.97e-02    
      18             27         1.0857e-04      5.98e-08       1.13e-06       2.75e-02    
      19             30         1.0856e-04      7.09e-09       1.42e-07       2.73e-02    
      20             32         1.0856e-04      3.51e-09       7.09e-08       2.71e-02    
      21             34         1.0855e-04      1.75e-09       3.54e-08       2.71e-02    
      22             37         1.0855e-04      2.18e-10       4.43e-09       2.70e-02    
`ftol` termination condition is satisfied.
Function evaluations 37, initial cost 4.9792e-03, final cost 1.0855e-04, first-order optimality 2.70e-02.
Final aspect ratio: 5.999599449651109
Final mean iota: 0.4185656997821267
Final magnetic well: -0.08819945744803913
Final quasisymmetry: 0.00021456940059031668
-------------------------
Optimizing with max_mode = 3
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.0855e-04                                    1.71e-01    
       1              4         4.4429e-05      6.41e-05       3.00e-03       5.29e-02    
       2              5         3.0984e-05      1.34e-05       6.01e-03       2.46e-01    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       3              7         1.5145e-05      1.58e-05       1.50e-03       1.85e+12    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       4             11         1.4681e-05      4.64e-07       4.69e-05       5.16e+11    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       5             15         1.4673e-05      8.47e-09       1.47e-06       4.82e+11    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       6             21         1.4662e-05      1.07e-08       2.86e-09       4.90e+11    
`xtol` termination condition is satisfied.
Function evaluations 21, initial cost 1.0855e-04, final cost 1.4662e-05, first-order optimality 4.90e+11.
Final aspect ratio: 6.000168032777229
Final mean iota: 0.419863402957861
Final magnetic well: -0.07453111240068797
Final quasisymmetry: 2.9220626709609916e-05
-------------------------
Optimizing with max_mode = 4
-------------------------
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.4662e-05                                    3.68e+12    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       1             12         1.4654e-05      8.37e-09       3.67e-07       3.60e+12    
       2             17         1.4654e-05      0.00e+00       0.00e+00       3.60e+12    
`xtol` termination condition is satisfied.
Function evaluations 17, initial cost 1.4662e-05, final cost 1.4654e-05, first-order optimality 3.60e+12.
Final aspect ratio: 6.000167723034444
Final mean iota: 0.4198572808788946
Final magnetic well: -0.07452867828594079
Final quasisymmetry: 2.920249272089251e-05
-------------------------
Optimizing with max_mode = 5
-------------------------
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.4654e-05                                    2.88e+13    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       1             13         1.4625e-05      2.88e-08       9.18e-08       2.89e+13    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=8 ntor=8)>
       2             17         1.4625e-05      0.00e+00       0.00e+00       2.89e+13    
`xtol` termination condition is satisfied.
Function evaluations 17, initial cost 1.4654e-05, final cost 1.4625e-05, first-order optimality 2.89e+13.
[Errno 2] No such file or directory: '/marconi_scratch/userexternal/rjorge00/some_optimizations/GS2_SIMSOPT_ITG/output_MAXITER350_least_squares_nfp2_QA_QA_onlyQS/mercier.nfp2_QA_000_000254'
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  SEQ =    1 TIME SLICE  0.0000E+00
  PROCESSING INPUT.final
  THIS IS PARVMEC (PARALLEL VMEC), VERSION 9.0
  Lambda: Full Radial Mesh. L-Force: hybrid full/half.

  COMPUTER:    OS:    RELEASE:   DATE = Dec 22,2022  TIME = 14:10:16

  NS =   16 NO. FOURIER MODES =  128 FTOLV =  1.000E-12 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1
 INITIAL JACOBIAN CHANGED SIGN!
 TRYING TO IMPROVE INITIAL MAGNETIC AXIS GUESS
  ---- Improved AXIS Guess ----
      RAXIS_CC =    1.0438073756005244       0.16347315649612301        1.7268187156216804E-002   1.2216748889825660E-003   1.3417510398797395E-003   4.9217626127467072E-004  -9.0854964578236967E-004   9.8013451088840094E-005   3.1477188847343072E-004
      ZAXIS_CS =   -0.0000000000000000      -0.15442630326739870       -1.9409028791847915E-002  -3.7468487791226966E-003   4.6759984923687415E-004   2.8129022057356017E-003   1.2545510946075579E-003  -1.1544167669315310E-003   2.3573602957455429E-004
  -----------------------------

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  2.75E-02  1.63E-02  2.40E-02  1.227E+00  9.00E-01  2.7922E-01
  200  5.66E-02  1.43E-03  5.79E-04  1.214E+00  9.00E-01  2.7592E-01
  400  6.79E-04  2.09E-05  6.27E-06  1.210E+00  9.00E-01  2.7590E-01
  600  1.67E-03  3.91E-05  2.08E-05  1.208E+00  9.00E-01  2.7590E-01
  800  6.40E-03  1.54E-04  8.31E-05  1.207E+00  9.00E-01  2.7590E-01
 1000  7.60E-03  1.91E-04  1.01E-04  1.206E+00  9.00E-01  2.7590E-01
 1200  2.31E-09  4.41E-10  6.95E-10  1.205E+00  8.74E-01  2.7590E-01
 1400  1.15E-10  2.43E-11  4.01E-11  1.204E+00  8.74E-01  2.7590E-01
 1600  1.47E-11  3.58E-12  5.63E-12  1.204E+00  8.74E-01  2.7590E-01
 1800  3.41E-12  8.55E-13  1.03E-12  1.204E+00  8.74E-01  2.7590E-01
 2000  1.12E-12  2.12E-13  1.25E-13  1.204E+00  8.74E-01  2.7590E-01
 2027  9.99E-13  1.82E-13  9.68E-14  1.204E+00  8.74E-01  2.7590E-01

  NS =   51 NO. FOURIER MODES =  128 FTOLV =  1.000E-13 NITER =  10000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  2.77E-03  1.85E-03  6.38E-06  1.204E+00  9.00E-01  2.7590E-01
  200  1.39E-04  2.03E-04  3.03E-06  1.204E+00  8.10E-01  2.7590E-01
  400  7.50E-09  2.79E-10  1.35E-10  1.204E+00  7.86E-01  2.7590E-01
  600  1.24E-10  8.89E-12  7.49E-12  1.204E+00  7.86E-01  2.7590E-01
  800  1.17E-11  1.48E-12  1.44E-12  1.204E+00  7.86E-01  2.7590E-01
 1000  4.37E-12  5.96E-13  3.70E-13  1.204E+00  7.86E-01  2.7590E-01
 1200  1.92E-12  2.87E-13  1.11E-13  1.204E+00  7.86E-01  2.7590E-01
 1400  1.17E-12  1.88E-13  6.62E-14  1.204E+00  7.86E-01  2.7590E-01
 1600  7.40E-13  1.13E-13  2.53E-14  1.204E+00  7.86E-01  2.7590E-01
 1800  4.39E-13  6.44E-14  8.91E-15  1.204E+00  7.86E-01  2.7590E-01
 2000  2.51E-13  3.75E-14  3.90E-15  1.204E+00  7.86E-01  2.7590E-01
 2200  1.37E-13  2.03E-14  1.69E-15  1.204E+00  7.86E-01  2.7590E-01
 2294  9.97E-14  1.47E-14  1.15E-15  1.204E+00  7.86E-01  2.7590E-01

  NS =  101 NO. FOURIER MODES =  128 FTOLV =  1.000E-14 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  2.81E-03  1.88E-03  1.57E-07  1.204E+00  9.00E-01  2.7590E-01
  200  8.70E-09  1.87E-09  1.34E-12  1.204E+00  6.37E-01  2.7590E-01
  400  3.23E-10  7.12E-11  2.13E-13  1.204E+00  6.37E-01  2.7590E-01
  600  2.51E-10  5.60E-11  1.20E-13  1.204E+00  6.37E-01  2.7590E-01
  800  8.17E-11  2.26E-11  5.61E-14  1.204E+00  6.37E-01  2.7590E-01
 1000  8.76E-12  3.44E-12  2.54E-14  1.204E+00  6.37E-01  2.7590E-01
 1200  1.69E-11  2.69E-12  9.08E-15  1.204E+00  6.37E-01  2.7590E-01
 1400  4.27E-12  8.12E-13  3.44E-15  1.204E+00  6.37E-01  2.7590E-01
 1600  9.10E-13  2.53E-13  1.61E-15  1.204E+00  6.37E-01  2.7590E-01
 1800  4.28E-13  9.90E-14  7.48E-16  1.204E+00  6.37E-01  2.7590E-01
 2000  3.30E-13  5.45E-14  3.17E-16  1.204E+00  6.37E-01  2.7590E-01
 2200  1.30E-13  2.13E-14  1.38E-16  1.204E+00  6.37E-01  2.7590E-01
 2400  5.77E-14  1.11E-14  8.05E-17  1.204E+00  6.37E-01  2.7590E-01
 2600  3.08E-14  5.80E-15  4.69E-17  1.204E+00  6.37E-01  2.7590E-01
 2800  1.71E-14  2.93E-15  2.96E-17  1.204E+00  6.37E-01  2.7590E-01
 2918  1.00E-14  1.75E-15  2.16E-17  1.204E+00  6.37E-01  2.7590E-01

 EXECUTION TERMINATED NORMALLY

 FILE : final_000_000000
 NUMBER OF JACOBIAN RESETS =    3

    TOTAL COMPUTATIONAL TIME (SEC)        68.40
    TIME TO INPUT/OUTPUT                   0.05
       READ IN DATA                        0.00
       WRITE OUT DATA TO WOUT              0.05
    TIME IN FUNCT3D                       67.98
       BCOVAR FIELDS                       8.72
       FOURIER TRANSFORM                  16.95
       INVERSE FOURIER TRANSFORM          17.03
       FORCES AND SYMMETRIZE               9.71
       RESIDUE                             8.32
       EQFORCE                             0.00
nfp:  2
ns:  101
mpol:  8
ntor:  8
Aminor_p:  0.17032456142372174
Rmajor_p:  1.021975880951756
aspect:             6.00016740045703
Rmajor_p/Aminor_p:  6.00016740045703
betatotal:  0.0
betapol:    0.0
betator:    0.0
betaxis:    0.0
ctor:    4.065758146820641e-12
bmnc.shape: (101, 242)
bmns.shape: (101, 242)
No module named 'mayavi'
Creating Boozer class for vmec_final
Defining surfaces where to compute Boozer coordinates
 booz_surfaces=[0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9]
Running BOOZ_XFORM
mnmax: 128  len(xm): 128  len(xn): 128
mnmax_nyq: 242  len(xm_nyq): 242  len(xn_nyq): 242
Read ns=101, mpol=8, ntor=8, mnmax=128, mnmax_nyq=242
compute_surfs (0-based indices):  0 10 20 30 39 49 60 70 79 89
Initializing with mboz=64, nboz=64
ntheta = 258, nzeta = 258, # threads = 24
                   |        outboard (theta=0)      |      inboard (theta=pi)      |
thread js_b js zeta| |B|input  |B|Boozer    Error   | |B|input  |B|Boozer    Error |
------------------------------------------------------------------------------------
   3     3  30   0  9.209e-01  9.209e-01  1.808e-15  1.048e+00  1.048e+00  1.547e-14
                pi  9.218e-01  9.218e-01  2.770e-15  1.047e+00  1.047e+00  1.124e-14
   1     1  10   0  9.499e-01  9.499e-01  1.391e-14  1.025e+00  1.025e+00  3.055e-14
                pi  9.501e-01  9.501e-01  2.220e-15  1.023e+00  1.023e+00  1.303e-14
   9     9  89   0  8.689e-01  8.689e-01  3.182e-14  1.082e+00  1.082e+00  6.627e-14
                pi  8.687e-01  8.687e-01  2.428e-15  1.089e+00  1.089e+00  1.836e-15
   7     7  70   0  8.831e-01  8.831e-01  1.207e-14  1.074e+00  1.074e+00  7.237e-15
                pi  8.836e-01  8.836e-01  2.262e-15  1.077e+00  1.077e+00  1.030e-15
   8     8  79   0  8.762e-01  8.762e-01  1.191e-14  1.078e+00  1.078e+00  9.063e-15
                pi  8.764e-01  8.764e-01  5.827e-15  1.083e+00  1.083e+00  1.251e-14
   5     5  49   0  9.012e-01  9.012e-01  4.805e-15  1.062e+00  1.062e+00  1.463e-14
                pi  9.021e-01  9.021e-01  9.231e-15  1.063e+00  1.063e+00  3.551e-15
   6     6  60   0  8.914e-01  8.914e-01  6.352e-15  1.069e+00  1.069e+00  1.101e-14
                pi  8.921e-01  8.921e-01  3.858e-15  1.071e+00  1.071e+00  9.331e-15
   2     2  20   0  9.337e-01  9.337e-01  3.924e-15  1.038e+00  1.038e+00  1.326e-14
                pi  9.343e-01  9.343e-01  1.069e-15  1.036e+00  1.036e+00  1.992e-14
   4     4  39   0  9.110e-01  9.110e-01  4.875e-15  1.055e+00  1.055e+00  1.536e-14
                pi  9.119e-01  9.119e-01  5.113e-15  1.055e+00  1.055e+00  6.104e-15
   0     0   0   0  9.806e-01  9.806e-01  2.593e-14  9.970e-01  9.970e-01  3.664e-14
                pi  9.797e-01  9.797e-01  1.961e-14  9.955e-01  9.955e-01  2.197e-14
Writing output to /marconi_scratch/userexternal/rjorge00/some_optimizations/GS2_SIMSOPT_ITG/output_MAXITER350_least_squares_nfp2_QA_QA_onlyQS/boozmn_single_stage.nc
Plot BOOZ_XFORM
Whole optimization took 3542.281187s
