Initial aspect ratio: 8.032497901971727
Initial mean iota: -0.9073727019754984
Initial magnetic well: -0.11352380119961178
Initial growth rate: 0.13170513617955243
## Now calculating total objective function ##
Total objective before optimization: 0.14152148143224927
-------------------------
Optimizing with max_mode = 1
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         7.0761e-02                                    1.80e-02    
       1              2         7.0650e-02      1.11e-04       1.70e-03       4.83e-01    
       2              6         7.0642e-02      7.99e-06       3.45e-05       5.38e-02    
       3             14         7.0642e-02      0.00e+00       0.00e+00       5.38e-02    
`xtol` termination condition is satisfied.
Function evaluations 14, initial cost 7.0761e-02, final cost 7.0642e-02, first-order optimality 5.38e-02.
Final aspect ratio: 8.030919198573356
Final mean iota: -0.9131519086372957
Final magnetic well: -0.11432923032894704
Final quasisymmetry: 0.1403281567675762
Final growth rate: 0.13031716284225575
## Now calculating total objective function ##
Total objective before optimization: 0.14128415360799568
-------------------------
Optimizing with max_mode = 2
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         7.0642e-02                                    5.54e+00    
       1              3         2.5652e-02      4.50e-02       1.68e-02       2.09e+01    
       2              4         1.2899e-02      1.28e-02       3.37e-02       1.42e+01    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       3              6         4.3684e-03      8.53e-03       8.42e-03       7.74e+12    
       4              8         3.2272e-03      1.14e-03       4.21e-03       1.16e+00    
       5              9         3.2141e-03      1.31e-05       8.42e-03       5.80e+00    
       6             10         2.2948e-03      9.19e-04       2.10e-03       2.47e-01    
       7             11         2.0581e-03      2.37e-04       4.21e-03       1.07e+00    
       8             13         1.9401e-03      1.18e-04       2.10e-03       2.79e-01    
       9             14         1.7975e-03      1.43e-04       4.21e-03       1.04e+00    
      10             16         1.7047e-03      9.28e-05       2.10e-03       2.06e-01    
      11             17         1.6171e-03      8.76e-05       4.21e-03       1.27e+00    
      12             19         1.5303e-03      8.68e-05       2.10e-03       4.30e-01    
      13             20         1.4892e-03      4.11e-05       4.21e-03       1.74e+00    
      14             21         1.4382e-03      5.09e-05       4.21e-03       2.15e+00    
      15             22         1.3723e-03      6.59e-05       4.21e-03       1.81e+00    
      16             23         1.3155e-03      5.68e-05       4.21e-03       2.14e+00    
      17             24         1.2582e-03      5.73e-05       4.21e-03       1.85e+00    
      18             25         1.2200e-03      3.82e-05       4.21e-03       1.96e+00    
      19             26         1.0320e-03      1.88e-04       1.05e-03       4.48e-01    
      20             27         1.0290e-03      2.99e-06       2.10e-03       7.54e-01    
      21             28         9.9561e-04      3.34e-05       5.26e-04       2.02e-01    
      22             30         9.9208e-04      3.53e-06       2.63e-04       1.07e-01    
      23             31         9.9173e-04      3.55e-07       5.26e-04       1.78e-01    
      24             32         9.8673e-04      5.00e-06       1.31e-04       4.56e-02    
      25             40         9.8659e-04      1.34e-07       1.61e-08       4.41e-02    
      26             43         9.8659e-04      0.00e+00       0.00e+00       4.41e-02    
`xtol` termination condition is satisfied.
Function evaluations 43, initial cost 7.0642e-02, final cost 9.8659e-04, first-order optimality 4.41e-02.
Final aspect ratio: 8.00058303746028
Final mean iota: -1.1529555062694508
Final magnetic well: -0.009929498561241062
Final quasisymmetry: 0.001972842937988566
Final growth rate: 0.20607797085670154
## Now calculating total objective function ##
Total objective before optimization: 0.0019731828706686643
-------------------------
Optimizing with max_mode = 3
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         9.8659e-04                                    3.06e+00    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       1              3         4.0020e-04      5.86e-04       7.84e-03       1.74e+12    
       2              6         1.9009e-04      2.10e-04       4.90e-04       3.48e-01    
       3              7         1.5117e-04      3.89e-05       9.81e-04       1.93e-01    
       4              8         1.3669e-04      1.45e-05       9.81e-04       2.21e-01    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=4 mpol=6 ntor=6)>
       5              9         1.2328e-04      1.34e-05       9.81e-04       4.96e+11    
       6             10         1.1859e-04      4.69e-06       9.81e-04       2.36e-01    
       7             12         1.1725e-04      1.34e-06       6.13e-05       9.23e-02    
       8             20         1.1725e-04      0.00e+00       0.00e+00       9.23e-02    
`xtol` termination condition is satisfied.
Function evaluations 20, initial cost 9.8659e-04, final cost 1.1725e-04, first-order optimality 9.23e-02.
Final aspect ratio: 8.000152945179478
Final mean iota: -1.1776820387126865
Final magnetic well: -0.006728701630295267
Final quasisymmetry: 0.00023448594835063044
Final growth rate: 0.20137259166932536
## Now calculating total objective function ##
Total objective before optimization: 0.0002345093405785556
-------------------------
Optimizing with max_mode = 4
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.1725e-04                                    3.50e-01    
       1              4         7.8431e-05      3.88e-05       1.96e-03       8.89e-01    
       2              6         7.1246e-05      7.18e-06       9.81e-04       2.41e-01    
       3              8         6.9918e-05      1.33e-06       2.45e-04       2.09e-01    
       4              9         6.9034e-05      8.84e-07       6.13e-05       1.81e-01    
       5             10         6.4801e-05      4.23e-06       1.53e-05       9.98e-02    
       6             13         6.4690e-05      1.11e-07       1.92e-06       2.26e-02    
       7             14         6.4645e-05      4.50e-08       1.92e-06       1.65e-02    
       8             15         6.4617e-05      2.87e-08       1.92e-06       1.52e-02    
       9             18         6.4616e-05      1.20e-09       1.20e-07       1.42e-02    
      10             19         6.4615e-05      2.60e-10       3.00e-08       1.41e-02    
      11             20         6.4615e-05      6.25e-11       7.49e-09       1.41e-02    
      12             21         6.4615e-05      1.54e-11       1.87e-09       1.41e-02    
`xtol` termination condition is satisfied.
Function evaluations 21, initial cost 1.1725e-04, final cost 6.4615e-05, first-order optimality 1.41e-02.
Final aspect ratio: 8.000084585717099
Final mean iota: -1.185307201167644
Final magnetic well: -0.0060733957750478814
Final quasisymmetry: 0.00012922326264324069
Final growth rate: 0.19927212336098557
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  SEQ =    1 TIME SLICE  0.0000E+00
  PROCESSING INPUT.final
  THIS IS PARVMEC (PARALLEL VMEC), VERSION 9.0
  Lambda: Full Radial Mesh. L-Force: hybrid full/half.

  COMPUTER:    OS:    RELEASE:   DATE = Dec 20,2022  TIME = 16:43:51

  NS =   16 NO. FOURIER MODES =   72 FTOLV =  1.000E-12 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1
 INITIAL JACOBIAN CHANGED SIGN!
 TRYING TO IMPROVE INITIAL MAGNETIC AXIS GUESS
  ---- Improved AXIS Guess ----
      RAXIS_CC =    1.0012879941111572       0.19718129938164233        1.4880162954921115E-002  -3.5835193409438585E-003   2.9512828063468855E-003   5.8656599026359133E-004  -2.6747618759326080E-003
      ZAXIS_CS =   -0.0000000000000000       0.15558759033065925        9.6455330742155516E-003  -1.4351910246944745E-003  -1.6231054917082216E-003  -2.2060882805932289E-003  -3.1441039361652752E-003
  -----------------------------

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  5.78E-02  4.37E-02  6.82E-02  1.211E+00  9.00E-01  1.8555E-01
  200  1.30E-08  5.86E-09  6.07E-09  1.204E+00  7.29E-01  1.7871E-01
  400  1.54E-10  8.39E-11  6.43E-11  1.204E+00  7.29E-01  1.7871E-01
  600  2.00E-11  9.94E-12  1.50E-11  1.204E+00  7.29E-01  1.7871E-01
  800  4.63E-12  1.65E-12  2.03E-12  1.204E+00  7.29E-01  1.7871E-01
  930  9.80E-13  4.60E-13  4.72E-13  1.204E+00  7.29E-01  1.7871E-01

  NS =   51 NO. FOURIER MODES =   72 FTOLV =  1.000E-13 NITER =  10000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  2.04E-02  7.06E-03  1.84E-05  1.204E+00  9.00E-01  1.7871E-01
  200  9.13E-09  4.90E-09  1.27E-10  1.205E+00  6.37E-01  1.7871E-01
  400  1.43E-10  4.94E-11  6.75E-12  1.204E+00  6.37E-01  1.7871E-01
  600  7.52E-12  2.64E-12  6.68E-13  1.204E+00  6.37E-01  1.7871E-01
  800  1.57E-12  4.99E-13  1.00E-13  1.204E+00  6.37E-01  1.7871E-01
 1000  3.98E-13  1.78E-13  5.04E-14  1.204E+00  6.37E-01  1.7871E-01
 1149  9.88E-14  4.00E-14  9.98E-15  1.204E+00  6.37E-01  1.7871E-01

  NS =  101 NO. FOURIER MODES =   72 FTOLV =  1.000E-14 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  1.64E-02  4.91E-03  2.99E-07  1.204E+00  9.00E-01  1.7871E-01
  200  2.11E-08  2.15E-08  1.64E-11  1.204E+00  5.09E-01  1.7871E-01
  400  6.30E-10  5.78E-10  9.38E-13  1.204E+00  5.09E-01  1.7871E-01
  600  7.79E-11  1.22E-10  1.22E-13  1.204E+00  5.09E-01  1.7871E-01
  800  7.65E-12  3.37E-12  1.93E-14  1.204E+00  5.09E-01  1.7871E-01
 1000  3.97E-12  2.09E-12  8.65E-15  1.204E+00  5.09E-01  1.7871E-01
 1200  1.01E-12  6.27E-13  3.19E-15  1.204E+00  5.09E-01  1.7871E-01
 1400  4.56E-13  1.63E-13  1.63E-15  1.204E+00  5.09E-01  1.7871E-01
 1600  8.18E-14  2.85E-14  5.04E-16  1.204E+00  5.09E-01  1.7871E-01
 1800  2.19E-14  5.67E-15  2.41E-16  1.204E+00  5.09E-01  1.7871E-01
 2000  1.11E-14  3.01E-15  1.30E-16  1.204E+00  5.09E-01  1.7871E-01
 2022  9.98E-15  2.57E-15  1.21E-16  1.204E+00  5.09E-01  1.7871E-01

 EXECUTION TERMINATED NORMALLY

 FILE : final_000_000000
 NUMBER OF JACOBIAN RESETS =    4

    TOTAL COMPUTATIONAL TIME (SEC)        25.65
    TIME TO INPUT/OUTPUT                   0.03
       READ IN DATA                        0.00
       WRITE OUT DATA TO WOUT              0.03
    TIME IN FUNCT3D                       25.49
       BCOVAR FIELDS                       3.66
       FOURIER TRANSFORM                   5.55
       INVERSE FOURIER TRANSFORM           5.21
       FORCES AND SYMMETRIZE               4.09
       RESIDUE                             4.54
       EQFORCE                             0.00
nfp:  4
ns:  101
mpol:  6
ntor:  6
Aminor_p:  0.1242199051835826
Rmajor_p:  0.9937697486984175
aspect:             8.000084585717088
Rmajor_p/Aminor_p:  8.000084585717088
betatotal:  0.0
betapol:    0.0
betator:    0.0
betaxis:    0.0
ctor:    -1.9542744159051217e-10
bmnc.shape: (101, 162)
bmns.shape: (101, 162)
No module named 'mayavi'
Creating Boozer class for vmec_final
Defining surfaces where to compute Boozer coordinates
 booz_surfaces=[0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9]
Running BOOZ_XFORM
mnmax: 72  len(xm): 72  len(xn): 72
mnmax_nyq: 162  len(xm_nyq): 162  len(xn_nyq): 162
Read ns=101, mpol=6, ntor=6, mnmax=72, mnmax_nyq=162
compute_surfs (0-based indices):  0 10 20 30 39 49 60 70 79 89
Initializing with mboz=64, nboz=64
ntheta = 258, nzeta = 258, # threads = 24
                   |        outboard (theta=0)      |      inboard (theta=pi)      |
thread js_b js zeta| |B|input  |B|Boozer    Error   | |B|input  |B|Boozer    Error |
------------------------------------------------------------------------------------
   0     0   0   0  1.076e+00  1.076e+00  1.403e-14  1.100e+00  1.100e+00  4.604e-14
                pi  1.100e+00  1.100e+00  4.038e-16  1.076e+00  1.076e+00  2.269e-14
   2     2  20   0  1.017e+00  1.017e+00  9.385e-15  1.168e+00  1.168e+00  7.412e-15
                pi  1.168e+00  1.168e+00  5.895e-15  1.018e+00  1.018e+00  1.636e-14
   5     5  49   0  9.816e-01  9.816e-01  5.881e-15  1.218e+00  1.218e+00  1.094e-14
                pi  1.216e+00  1.216e+00  5.842e-15  9.819e-01  9.819e-01  1.651e-14
   7     7  70   0  9.629e-01  9.629e-01  9.224e-15  1.247e+00  1.247e+00  1.140e-14
                pi  1.243e+00  1.243e+00  2.073e-14  9.630e-01  9.630e-01  4.612e-16
   6     6  60   0  9.714e-01  9.714e-01  8.572e-15  1.234e+00  1.234e+00  8.820e-15
                pi  1.231e+00  1.231e+00  1.137e-14  9.715e-01  9.715e-01  9.942e-15
   9     9  89   0  9.485e-01  9.485e-01  2.177e-14  1.270e+00  1.270e+00  6.119e-15
                pi  1.262e+00  1.262e+00  1.461e-14  9.482e-01  9.482e-01  6.323e-15
   4     4  39   0  9.922e-01  9.922e-01  6.714e-15  1.203e+00  1.203e+00  1.311e-14
                pi  1.202e+00  1.202e+00  8.316e-15  9.925e-01  9.925e-01  2.662e-14
   1     1  10   0  1.036e+00  1.036e+00  2.357e-14  1.144e+00  1.144e+00  1.552e-14
                pi  1.144e+00  1.144e+00  7.764e-16  1.037e+00  1.037e+00  1.285e-15
   8     8  79   0  9.559e-01  9.559e-01  6.272e-15  1.258e+00  1.258e+00  3.177e-15
                pi  1.252e+00  1.252e+00  8.867e-15  9.558e-01  9.558e-01  2.323e-16
   3     3  30   0  1.003e+00  1.003e+00  5.092e-15  1.188e+00  1.188e+00  2.150e-14
                pi  1.187e+00  1.187e+00  1.665e-14  1.003e+00  1.003e+00  1.881e-14
Writing output to /marconi_scratch/userexternal/rjorge00/some_optimizations/GS2_SIMSOPT_ITG/output_MAXITER350_least_squares_nfp4_QH_QH_onlyQS/boozmn_single_stage.nc
Plot BOOZ_XFORM
Whole optimization took 2579.139563s
