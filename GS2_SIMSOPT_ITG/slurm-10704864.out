Initial aspect ratio: 6.0029902490248235
Initial mean iota: 0.39940028561642876
Initial magnetic well: -0.04553581079649515
Initial growth rate: 0.2773230515086659
## Now calculating total objective function ##
Total objective before optimization: 0.009948412376369013
-------------------------
Optimizing with max_mode = 1
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         4.9742e-03                                    9.44e-04    
       1              9         4.9742e-03      1.39e-10       1.17e-07       7.17e-04    
       2             11         4.9742e-03      2.12e-11       5.84e-08       6.10e-04    
`ftol` termination condition is satisfied.
Function evaluations 11, initial cost 4.9742e-03, final cost 4.9742e-03, first-order optimality 6.10e-04.
Final aspect ratio: 6.002988383734161
Final mean iota: 0.3994001222738967
Final magnetic well: -0.04553583202266892
Final quasisymmetry: 0.009515126656087924
Final growth rate: 0.277330179651682
## Now calculating total objective function ##
Total objective before optimization: 0.009948412055760908
-------------------------
Optimizing with max_mode = 2
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         4.9742e-03                                    8.23e-01    
       1              3         2.3227e-03      2.65e-03       1.79e-02       6.24e-01    
       2              5         1.3431e-03      9.80e-04       8.95e-03       2.11e-01    
       3              6         7.4401e-04      5.99e-04       1.79e-02       1.34e+00    
       4              7         4.4092e-04      3.03e-04       1.79e-02       1.10e+00    
       5              8         2.7249e-04      1.68e-04       1.79e-02       7.67e-01    
       6             10         1.4486e-04      1.28e-04       4.48e-03       9.15e-02    
       7             12         1.3821e-04      6.65e-06       2.24e-03       5.11e-02    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
       8             13         1.3466e-04      3.55e-06       2.24e-03       9.67e+12    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
       9             14         1.3145e-04      3.21e-06       2.24e-03       2.35e+12    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      10             15         1.2940e-04      2.05e-06       5.59e-04       1.35e+12    
      11             16         1.2896e-04      4.38e-07       5.59e-04       1.65e-02    
      12             20         1.2895e-04      1.07e-08       2.19e-06       1.60e-02    
      13             21         1.2895e-04      1.39e-09       5.46e-07       1.58e-02    
      14             22         1.2895e-04      2.71e-10       1.37e-07       1.58e-02    
      15             23         1.2895e-04      6.39e-11       3.41e-08       1.58e-02    
      16             24         1.2895e-04      1.62e-11       8.54e-09       1.58e-02    
      17             25         1.2895e-04      3.53e-12       2.13e-09       1.58e-02    
`xtol` termination condition is satisfied.
Function evaluations 25, initial cost 4.9742e-03, final cost 1.2895e-04, first-order optimality 1.58e-02.
Final aspect ratio: 5.99999453382724
Final mean iota: 0.41829361809262794
Final magnetic well: -0.08903144216239114
Final quasisymmetry: 0.0002549932937241698
Final growth rate: 0.2445930306787419
## Now calculating total objective function ##
Total objective before optimization: 0.000257905062817022
-------------------------
Optimizing with max_mode = 3
-------------------------
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.2895e-04                                    1.28e-01    
       1              4         5.5807e-05      7.31e-05       2.56e-03       5.37e-02    
       2              5         3.5486e-05      2.03e-05       5.12e-03       1.78e-01    
       3              7         2.0191e-05      1.53e-05       1.28e-03       3.43e-02    
       4              8         1.9819e-05      3.72e-07       2.56e-03       1.03e-01    
       5              9         1.3882e-05      5.94e-06       6.40e-04       2.14e-02    
       6             11         1.3256e-05      6.27e-07       3.20e-04       9.17e-03    
       7             12         1.2413e-05      8.43e-07       3.20e-04       1.08e-02    
       8             13         1.2235e-05      1.78e-07       6.40e-04       2.80e-02    
       9             14         1.2184e-05      5.08e-08       1.60e-04       8.22e-03    
      10             15         1.2180e-05      3.84e-09       4.00e-05       8.30e-03    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      11             16         1.2178e-05      2.33e-09       1.00e-05       9.78e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      12             17         1.2177e-05      9.10e-10       2.50e-06       9.55e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      13             18         1.2177e-05      2.26e-10       6.25e-07       9.50e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      14             19         1.2177e-05      5.62e-11       1.56e-07       9.49e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      15             20         1.2177e-05      1.35e-11       3.91e-08       9.48e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      16             21         1.2177e-05      3.52e-12       9.76e-09       9.48e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
      17             22         1.2177e-05      8.53e-13       2.44e-09       9.48e+10    
`xtol` termination condition is satisfied.
Function evaluations 22, initial cost 1.2895e-04, final cost 1.2177e-05, first-order optimality 9.48e+10.
Final aspect ratio: 5.9999754491898045
Final mean iota: 0.4198782855872033
Final magnetic well: -0.07330274606600762
Final quasisymmetry: 2.4337847852029484e-05
Final growth rate: 0.24956938528718559
## Now calculating total objective function ##
Total objective before optimization: 2.435326499259315e-05
-------------------------
Optimizing with max_mode = 4
-------------------------
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.2177e-05                                    9.48e+10    
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
WARNING:simsopt.objectives.least_squares:Function evaluation failed for <bound method Vmec.aspect of Vmec1 (nfp=2 mpol=6 ntor=6)>
       1              7         1.0946e-05      1.23e-06       3.67e-04       6.98e-02    
       2             10         1.0207e-05      7.39e-07       4.59e-05       3.59e-02    
       3             11         9.9076e-06      2.99e-07       4.59e-05       3.00e-02    
       4             12         9.2540e-06      6.54e-07       4.59e-05       1.97e-02    
       5             13         8.9635e-06      2.90e-07       9.18e-05       2.72e-02    
       6             15         8.9056e-06      5.79e-08       2.30e-05       2.86e-02    
       7             16         8.9003e-06      5.35e-09       5.74e-06       2.93e-02    
       8             22         8.9003e-06      0.00e+00       0.00e+00       2.93e-02    
`xtol` termination condition is satisfied.
Function evaluations 22, initial cost 1.2177e-05, final cost 8.9003e-06, first-order optimality 2.93e-02.
Final aspect ratio: 5.999979165039815
Final mean iota: 0.4199864095489865
Final magnetic well: -0.07311643298972198
Final quasisymmetry: 1.7799934982698045e-05
Final growth rate: 0.24949800215573686
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  SEQ =    1 TIME SLICE  0.0000E+00
  PROCESSING INPUT.final
  THIS IS PARVMEC (PARALLEL VMEC), VERSION 9.0
  Lambda: Full Radial Mesh. L-Force: hybrid full/half.

  COMPUTER:    OS:    RELEASE:   DATE = Dec 20,2022  TIME = 16:39:09

  NS =   16 NO. FOURIER MODES =   72 FTOLV =  1.000E-12 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1
 INITIAL JACOBIAN CHANGED SIGN!
 TRYING TO IMPROVE INITIAL MAGNETIC AXIS GUESS
  ---- Improved AXIS Guess ----
      RAXIS_CC =    1.0286807469094168       0.16619346312455047        1.6676540684672406E-002   1.9918353578059862E-003   6.5496383312880981E-004  -1.1242675271994778E-003   5.5629381020456589E-004
      ZAXIS_CS =   -0.0000000000000000      -0.16249860447806222       -2.0718121969210204E-002  -2.9308211462921881E-003   8.5117970527983072E-005   2.4041005909248810E-004  -9.4257889569273907E-004
  -----------------------------

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  1.65E-02  1.01E-02  1.26E-02  1.214E+00  9.00E-01  2.8032E-01
  200  1.06E-04  2.54E-06  6.09E-07  1.200E+00  9.00E-01  2.7835E-01
  400  3.20E-09  3.73E-10  6.76E-10  1.195E+00  9.00E-01  2.7835E-01
  600  7.08E-11  1.91E-11  2.15E-11  1.195E+00  9.00E-01  2.7835E-01
  800  1.47E-11  3.15E-12  1.89E-12  1.195E+00  9.00E-01  2.7835E-01
 1000  2.43E-12  4.99E-13  1.65E-13  1.195E+00  9.00E-01  2.7835E-01
 1080  9.95E-13  2.01E-13  5.49E-14  1.195E+00  9.00E-01  2.7835E-01

  NS =   51 NO. FOURIER MODES =   72 FTOLV =  1.000E-13 NITER =  10000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  1.17E-03  8.71E-04  2.09E-06  1.195E+00  9.00E-01  2.7834E-01
  200  1.84E-09  3.96E-10  4.01E-11  1.195E+00  7.76E-01  2.7834E-01
  400  1.58E-11  4.99E-12  9.71E-13  1.195E+00  7.76E-01  2.7834E-01
  600  1.49E-12  3.51E-13  5.79E-14  1.195E+00  7.76E-01  2.7834E-01
  800  3.52E-13  7.94E-14  5.84E-15  1.195E+00  7.76E-01  2.7834E-01
 1000  1.23E-13  2.53E-14  1.11E-15  1.195E+00  7.76E-01  2.7834E-01
 1033  9.99E-14  2.03E-14  8.38E-16  1.195E+00  7.76E-01  2.7834E-01

  NS =  101 NO. FOURIER MODES =   72 FTOLV =  1.000E-14 NITER =   4000
  PROCESSOR COUNT - RADIAL:    1

  ITER    FSQR      FSQZ      FSQL    RAX(v=0)    DELT       WMHD

    1  7.80E-04  5.13E-04  1.40E-07  1.195E+00  9.00E-01  2.7834E-01
  200  2.95E-09  6.76E-10  1.48E-12  1.195E+00  6.18E-01  2.7834E-01
  400  6.90E-11  1.30E-11  2.01E-13  1.195E+00  6.18E-01  2.7834E-01
  600  6.56E-12  2.40E-12  2.89E-14  1.195E+00  6.18E-01  2.7834E-01
  800  8.34E-13  2.56E-13  3.38E-15  1.195E+00  6.18E-01  2.7834E-01
 1000  1.19E-13  3.21E-14  9.79E-16  1.195E+00  6.18E-01  2.7834E-01
 1200  4.39E-14  1.04E-14  3.31E-16  1.195E+00  6.18E-01  2.7834E-01
 1400  1.74E-14  4.11E-15  9.78E-17  1.195E+00  6.18E-01  2.7834E-01
 1505  9.98E-15  2.29E-15  5.07E-17  1.194E+00  6.18E-01  2.7834E-01

 EXECUTION TERMINATED NORMALLY

 FILE : final_000_000000
 NUMBER OF JACOBIAN RESETS =    3

    TOTAL COMPUTATIONAL TIME (SEC)        20.64
    TIME TO INPUT/OUTPUT                   0.03
       READ IN DATA                        0.00
       WRITE OUT DATA TO WOUT              0.03
    TIME IN FUNCT3D                       20.49
       BCOVAR FIELDS                       2.93
       FOURIER TRANSFORM                   4.47
       INVERSE FOURIER TRANSFORM           4.17
       FORCES AND SYMMETRIZE               3.32
       RESIDUE                             3.65
       EQFORCE                             0.00
nfp:  2
ns:  101
mpol:  6
ntor:  6
Aminor_p:  0.16917303144975696
Rmajor_p:  1.0150346639851655
aspect:             5.9999791650398056
Rmajor_p/Aminor_p:  5.9999791650398056
betatotal:  0.0
betapol:    0.0
betator:    0.0
betaxis:    0.0
ctor:    8.077306185017008e-11
bmnc.shape: (101, 162)
bmns.shape: (101, 162)
No module named 'mayavi'
Creating Boozer class for vmec_final
Defining surfaces where to compute Boozer coordinates
 booz_surfaces=[0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9]
Running BOOZ_XFORM
mnmax: 72  len(xm): 72  len(xn): 72
mnmax_nyq: 162  len(xm_nyq): 162  len(xn_nyq): 162
Read ns=101, mpol=6, ntor=6, mnmax=72, mnmax_nyq=162
compute_surfs (0-based indices):  0 10 20 30 39 49 60 70 79 89
Initializing with mboz=64, nboz=64
ntheta = 258, nzeta = 258, # threads = 24
                   |        outboard (theta=0)      |      inboard (theta=pi)      |
thread js_b js zeta| |B|input  |B|Boozer    Error   | |B|input  |B|Boozer    Error |
------------------------------------------------------------------------------------
   0     0   0   0  9.946e-01  9.946e-01  1.875e-14  1.012e+00  1.012e+00  3.401e-14
                pi  9.936e-01  9.936e-01  3.575e-15  1.011e+00  1.011e+00  1.384e-14
   9     9  89   0  8.795e-01  8.795e-01  1.792e-14  1.106e+00  1.106e+00  5.822e-15
                pi  8.791e-01  8.791e-01  2.627e-14  1.111e+00  1.111e+00  4.997e-15
   5     5  49   0  9.125e-01  9.125e-01  2.433e-16  1.083e+00  1.083e+00  9.640e-15
                pi  9.124e-01  9.124e-01  1.071e-14  1.084e+00  1.084e+00  1.024e-14
   2     2  20   0  9.458e-01  9.458e-01  5.048e-15  1.056e+00  1.056e+00  1.450e-14
                pi  9.456e-01  9.456e-01  1.996e-15  1.055e+00  1.055e+00  1.894e-15
   8     8  79   0  8.870e-01  8.870e-01  5.507e-15  1.101e+00  1.101e+00  1.613e-14
                pi  8.867e-01  8.867e-01  7.012e-15  1.105e+00  1.105e+00  8.038e-16
   6     6  60   0  9.025e-01  9.025e-01  2.817e-14  1.090e+00  1.090e+00  2.057e-14
                pi  9.024e-01  9.024e-01  1.464e-14  1.092e+00  1.092e+00  1.077e-14
   3     3  30   0  9.327e-01  9.327e-01  3.095e-15  1.067e+00  1.067e+00  3.538e-15
                pi  9.326e-01  9.326e-01  1.191e-15  1.067e+00  1.067e+00  8.328e-16
   7     7  70   0  8.941e-01  8.941e-01  1.416e-14  1.096e+00  1.096e+00  1.499e-14
                pi  8.939e-01  8.939e-01  2.236e-15  1.099e+00  1.099e+00  5.656e-15
   4     4  39   0  9.226e-01  9.226e-01  6.859e-15  1.075e+00  1.075e+00  1.467e-14
                pi  9.225e-01  9.225e-01  1.204e-16  1.075e+00  1.075e+00  1.033e-15
   1     1  10   0  9.624e-01  9.624e-01  1.846e-15  1.042e+00  1.042e+00  1.108e-14
                pi  9.621e-01  9.621e-01  3.462e-15  1.040e+00  1.040e+00  1.281e-15
Writing output to /marconi_scratch/userexternal/rjorge00/some_optimizations/GS2_SIMSOPT_ITG/output_MAXITER350_least_squares_nfp2_QA_QA_onlyQS/boozmn_single_stage.nc
Plot BOOZ_XFORM
Whole optimization took 2283.444500s
